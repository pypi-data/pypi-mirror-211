(self.webpackChunkipylgbst=self.webpackChunkipylgbst||[]).push([[367],{657:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MODULE_NAME=e.MODULE_VERSION=void 0;const o=n(147);e.MODULE_VERSION=o.version,e.MODULE_NAME=o.name},367:function(t,e,n){"use strict";var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(i,s){function l(t){try{c(o.next(t))}catch(t){s(t)}}function r(t){try{c(o.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,r)}c((o=o.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.LegoBoostView=e.LegoBoostModel=void 0;const s=n(829),l=n(657);n(204);const r=i(n(430)),c={};class a extends s.DOMWidgetModel{constructor(){super(...arguments),this.polling_frame=0,this.polling_is_running=!1,this.stop_polling=!1,this.lane_cmd_index=[0],this.lanes=[Promise.resolve(),Promise.resolve(),Promise.resolve()]}defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:a.model_name,_model_module:a.model_module,_model_module_version:a.model_module_version,_view_name:a.view_name,_view_module:a.view_module,_view_module_version:a.view_module_version,_device_info:{},name:"device1",n_lanes:3})}save_device_info(){const t=Object.assign({polling_frame:this.polling_frame,lane_cmd_index:this.lane_cmd_index},this.boost.deviceInfo);this.set("_device_info",t),this.save_changes()}poll(){this.polling_frame+=1,this.save_device_info()}polling(){this.poll(),this.stop_polling?this.polling_is_running=!1:(this.polling_is_running=!0,setTimeout(this.polling.bind(this),200))}initialize(t,e){super.initialize(t,e);const n=this.get("n_lanes");console.log(`initialize with n_lanes=${n}`,this);const i=this.get("name");console.log(`initialize with name=${i}`),i in c||(c[i]=new r.default),this.boost=c[i],this.on("msg:custom",((t,e)=>o(this,void 0,void 0,(function*(){const n=t.lane;this.lanes[n]=this.lanes[n].then((()=>o(this,void 0,void 0,(function*(){const o=t.args,i=t.args,s=this.onCommand(t,e);i&&(yield s),o&&(this.lane_cmd_index[n]+=1,this.save_device_info())}))))}))))}onCommand(t,e){return o(this,void 0,void 0,(function*(){console.log("onCommand",t);const e=t.command,n=t.args;if("connect"===e)yield this.connect();else if("disconnect"===e)this.disconnect();else if(this.boost.deviceInfo.connected)switch(e){case"poll":this.poll();break;case"led":this.boost.led.apply(this.boost,n);break;case"ledAsync":yield this.boost.ledAsync.apply(this.boost,n);break;case"motorTime":this.boost.motorTime.apply(this.boost,n);break;case"motorTimeMulti":this.boost.motorTimeMulti.apply(this.boost,n);break;case"motorTimeAsync":yield this.boost.motorTimeAsync.apply(this.boost,n);break;case"motorTimeMultiAsync":yield this.boost.motorTimeMultiAsync.apply(this.boost,n);break;case"motorAngle":this.boost.motorAngle.apply(this.boost,n);break;case"motorAngleMulti":this.boost.motorAngleMulti.apply(this.boost,n);break;case"motorAngleAsync":yield this.boost.motorAngleAsync.apply(this.boost,n);break;case"motorAngleMultiAsync":yield this.boost.motorAngleMultiAsync.apply(this.boost,n);break;default:console.error(`unknown command "${e}"`)}else console.log(`cannot run command ${e} since we are not connected`)}))}connect(){return o(this,void 0,void 0,(function*(){const t=t=>new Promise((e=>setTimeout(e,t)));if(!this.boost.deviceInfo.connected){console.log("not connected yet"),yield this.boost.connect();for(let e=0;e<30&&(yield t(100),!this.boost.deviceInfo.connected||void 0===this.boost.hub||!this.boost.hub.connected);e++);yield t(4e3)}const e=this.get("n_lanes");for(;this.lane_cmd_index.length<e;)this.lane_cmd_index.push(0);this.polling_is_running||(this.polling_is_running=!0,setTimeout(this.polling.bind(this),200))}))}disconnect(){console.log("disconnect"),this.boost.disconnect()}dispose(){console.log("remove model")}}e.LegoBoostModel=a,a.serializers=Object.assign({},s.DOMWidgetModel.serializers),a.model_name="LegoBoostModel",a.model_module=l.MODULE_NAME,a.model_module_version=l.MODULE_VERSION,a.view_name="LegoBoostView",a.view_module=l.MODULE_NAME,a.view_module_version=l.MODULE_VERSION;class d extends s.DOMWidgetView{constructor(){super(...arguments),this.isWebBluetoothSupported=!!navigator.bluetooth}render(){if(this.el.classList.add("custom-widget"),!this.isWebBluetoothSupported){const t=document.createElement("div");t.classList.add("error-box"),this.el.appendChild(t),this.txt_bluetooth=document.createElement("div"),this.txt_bluetooth.textContent="Your device doesn't support Web Bluetooth API. Try to turn on Experimental Platform Features from Chrome, by accessing the following link and turning it on: chrome://flags/#enable-experimental-web-platform-features",t.appendChild(this.txt_bluetooth),console.log("Your device doesn't support Web Bluetooth API. Try to turn on Experimental Platform Features from Chrome, by accessing the following link and turning it on: chrome://flags/#enable-experimental-web-platform-features")}const t=document.createElement("div");t.classList.add("box"),this.el.appendChild(t);const e=document.createElement("div");e.classList.add("box"),this.el.appendChild(e);const n=document.createElement("div");n.classList.add("box"),this.el.appendChild(n),this.txt_connected=document.createElement("div"),this.txt_connected.textContent="Disconnected",t.appendChild(this.txt_connected),this.txt_pitch=document.createElement("div"),this.txt_pitch.textContent="pitch1:",e.appendChild(this.txt_pitch),this.meter_pitch=document.createElement("meter"),e.appendChild(this.meter_pitch),this.meter_pitch.min=-90,this.meter_pitch.max=90,this.el.appendChild(document.createElement("br")),this.txt_roll=document.createElement("div"),this.txt_roll.textContent="roll:",e.appendChild(this.txt_roll),this.meter_roll=document.createElement("meter"),e.appendChild(this.meter_roll),this.meter_roll.min=-90,this.meter_roll.max=90,e.appendChild(document.createElement("br")),this.txt_distance=document.createElement("div"),this.txt_distance.textContent="distance:",e.appendChild(this.txt_distance),this.meter_distance=document.createElement("meter"),e.appendChild(this.meter_distance),this.meter_distance.min=0,this.meter_distance.max=255,e.appendChild(document.createElement("br")),this.txt_color=document.createElement("div"),this.txt_color.textContent="color:",e.appendChild(this.txt_color),this.color_color=document.createElement("div"),e.appendChild(this.color_color),this.color_color.textContent="None",this.changes(),n.appendChild(document.createElement("br")),this.txt_port_a=document.createElement("div"),this.txt_port_a.textContent="Port A:",n.appendChild(this.txt_port_a),n.appendChild(document.createElement("br")),this.txt_port_b=document.createElement("div"),this.txt_port_b.textContent="Port B:",n.appendChild(this.txt_port_b),n.appendChild(document.createElement("br")),this.txt_port_ab=document.createElement("div"),this.txt_port_ab.textContent="Port AB:",n.appendChild(this.txt_port_ab),n.appendChild(document.createElement("br")),this.txt_port_c=document.createElement("div"),this.txt_port_c.textContent="Port C:",n.appendChild(this.txt_port_c),n.appendChild(document.createElement("br")),this.txt_port_d=document.createElement("div"),this.txt_port_d.textContent="Port D:",n.appendChild(this.txt_port_d),this.model.on("change:_device_info",this.changes,this)}changes(){const t=this.model.boost.deviceInfo;if(void 0!==t.connected&&t.connected){this.txt_connected.textContent="Connected",this.meter_roll.value=t.tilt.roll,this.txt_roll.textContent=`roll: ${t.tilt.roll}`,this.meter_pitch.value=t.tilt.pitch,this.txt_pitch.textContent=`pitch1: ${t.tilt.pitch}`;const e=t.distance;null!=e&&isFinite(e)?(this.meter_distance.value=e,this.txt_distance.textContent=`distance: ${e}`):(this.meter_distance.value=255,this.txt_distance.textContent="distance: âˆž");const n=t.color;null!=n?(this.color_color.textContent=`${n}`,this.color_color.style.backgroundColor=n):(this.color_color.textContent="None",this.color_color.style.backgroundColor="#444"),this.txt_port_a.textContent=`Port A:  ${t.ports.A.action} ${t.ports.A.angle}`,this.txt_port_b.textContent=`Port B:  ${t.ports.B.action} ${t.ports.B.angle}`,this.txt_port_ab.textContent=`Port AB: ${t.ports.AB.action} ${t.ports.AB.angle}`,this.txt_port_c.textContent=`Port C:  ${t.ports.C.action} ${t.ports.C.angle}`,this.txt_port_d.textContent=`Port D:  ${t.ports.D.action} ${t.ports.D.angle}`}else this.txt_connected.textContent="Disconnected"}remove(){this.model.stop_polling=!0}}e.LegoBoostView=d},889:(t,e,n)=>{(e=n(645)(!1)).push([t.id,".custom-widget {\n  \n}\n\n\n\n.custom-widget  {\n  display: grid;\n  grid-template-columns: 200px 200px 200px 200px;\n  grid-gap: 10px;\n  background-color: #fff;\n  color: #444;\n  background-color: white;\n  padding: 0px 2px;\n}\n\n.box {\n  background-color: #444;\n  color: #fff;\n  border-radius: 5px;\n  padding: 20px;\n  font-size: 100%;\n}\n\n.error-box {\n  background-color: #ffffff;\n  color: #000000;\n  border-radius: 5px;\n  padding: 20px;\n  font-size: 100%;\n}\n",""]),t.exports=e},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n,o,i,s=t[1]||"",l=t[3];if(!l)return s;if(e&&"function"==typeof btoa){var r=(n=l,o=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(i," */")),c=l.sources.map((function(t){return"/*# sourceURL=".concat(l.sourceRoot||"").concat(t," */")}));return[s].concat(c).concat([r]).join("\n")}return[s].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,o){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(o)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(i[l]=!0)}for(var r=0;r<t.length;r++){var c=[].concat(t[r]);o&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),e.push(c))}},e}},204:(t,e,n)=>{var o=n(379),i=n(889);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.id,i,""]]);o(i,{insert:"head",singleton:!1}),t.exports=i.locals||{}},379:(t,e,n)=>{"use strict";var o,i=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),s=[];function l(t){for(var e=-1,n=0;n<s.length;n++)if(s[n].identifier===t){e=n;break}return e}function r(t,e){for(var n={},o=[],i=0;i<t.length;i++){var r=t[i],c=e.base?r[0]+e.base:r[0],a=n[c]||0,d="".concat(c," ").concat(a);n[c]=a+1;var p=l(d),u={css:r[1],media:r[2],sourceMap:r[3]};-1!==p?(s[p].references++,s[p].updater(u)):s.push({identifier:d,updater:b(u,e),references:1}),o.push(d)}return o}function c(t){var e=document.createElement("style"),o=t.attributes||{};if(void 0===o.nonce){var s=n.nc;s&&(o.nonce=s)}if(Object.keys(o).forEach((function(t){e.setAttribute(t,o[t])})),"function"==typeof t.insert)t.insert(e);else{var l=i(t.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(e)}return e}var a,d=(a=[],function(t,e){return a[t]=e,a.filter(Boolean).join("\n")});function p(t,e,n,o){var i=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(t.styleSheet)t.styleSheet.cssText=d(e,i);else{var s=document.createTextNode(i),l=t.childNodes;l[e]&&t.removeChild(l[e]),l.length?t.insertBefore(s,l[e]):t.appendChild(s)}}function u(t,e,n){var o=n.css,i=n.media,s=n.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}var h=null,m=0;function b(t,e){var n,o,i;if(e.singleton){var s=m++;n=h||(h=c(e)),o=p.bind(null,n,s,!1),i=p.bind(null,n,s,!0)}else n=c(e),o=u.bind(null,n,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o));var n=r(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var o=0;o<n.length;o++){var i=l(n[o]);s[i].references--}for(var c=r(t,e),a=0;a<n.length;a++){var d=l(n[a]);0===s[d].references&&(s[d].updater(),s.splice(d,1))}n=c}}}},147:t=>{"use strict";t.exports=JSON.parse('{"name":"ipylgbst","version":"0.2.1","description":"A widget library for controlling LEGOÂ® BOOST via web-bluetooth","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js","css/*.css"],"homepage":"https://github.com/jupyterlab-contrib-ipylgbst","bugs":{"url":"https://github.com/jupyterlab-contrib-ipylgbst/issues"},"license":"BSD-3-Clause","author":{"name":"Thorsten Beier","email":"derthorstenbeier@gmail.com"},"main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/jupyterlab-contrib-ipylgbst"},"scripts":{"build":"jlpm run build:lib && jlpm run build:nbextension && jlpm run build:labextension:dev","build:prod":"jlpm run build:lib && jlpm run build:nbextension && jlpm run build:labextension","build:labextension":"jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True .","build:lib":"tsc","build:nbextension":"webpack","clean":"jlpm run clean:lib && jlpm run clean:nbextension && jlpm run clean:labextension","clean:lib":"rimraf lib","clean:labextension":"rimraf ipylgbst/labextension","clean:nbextension":"rimraf ipylgbst/nbextension/static/index.js","install:extension":"jlpm build","lint":"eslint . --ext .ts,.tsx --fix","lint:check":"eslint . --ext .ts,.tsx","prepack":"jlpm run build:lib","test":"jest","watch":"npm-run-all -p watch:*","watch:lib":"tsc -w","watch:nbextension":"webpack --watch --mode=development","watch:labextension":"jupyter labextension watch ."},"dependencies":{"@jupyter-widgets/base":"^1.1.10 || ^2 || ^3 || ^4 || ^5 || ^6","@lumino/application":"^1.6.0","@lumino/widgets":"^1.6.0","add":"^2.0.6","ieee754":"^1.2.1","lego-boost-browser":"git+https://github.com/DerThorsten/lego-boost-browser.git"},"devDependencies":{"@babel/core":"^7.5.0","@babel/preset-env":"^7.5.0","@jupyter-widgets/base-manager":"^1.0.2","@jupyterlab/builder":"^3.0.0","@types/jest":"^26.0.0","@types/webpack-env":"^1.13.6","@typescript-eslint/eslint-plugin":"^3.6.0","@typescript-eslint/parser":"^3.6.0","acorn":"^7.2.0","css-loader":"^3.2.0","eslint":"^7.4.0","eslint-config-prettier":"^6.11.0","eslint-plugin-prettier":"^3.1.4","fs-extra":"^7.0.0","identity-obj-proxy":"^3.0.0","jest":"^26.0.0","mkdirp":"^0.5.1","npm-run-all":"^4.1.3","prettier":"^2.0.5","rimraf":"^2.6.2","source-map-loader":"^1.1.3","style-loader":"^1.0.0","ts-jest":"^26.0.0","ts-loader":"^8.0.0","typescript":"~4.1.3","webpack":"^5.61.0","webpack-cli":"^4.0.0"},"jupyterlab":{"extension":"lib/plugin","outputDir":"ipylgbst/labextension/","sharedPackages":{"@jupyter-widgets/base":{"bundled":false,"singleton":true}}}}')}}]);