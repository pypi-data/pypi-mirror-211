"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_performance_layouts_index_tsx-app_views_starfish_components_miniChartPanel_tsx-1951a7"],{"./app/components/performance/layouts/index.tsx":(e,t,i)=>{i.d(t,{c:()=>s});var a=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=i("./app/styles/space.tsx");const s=(0,a.Z)("div",{target:"ez22r7r0"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,n.D)(2),";grid-row-gap:",(0,n.D)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(e=>e.theme.breakpoints.medium),"){",(e=>e.columns?`\n    grid-template-columns: repeat(${e.columns}, 1fr);\n    `:`\n    grid-template-columns: repeat(auto-fit, minmax(${e.minSize}px, 1fr));\n    `),";}")},"./app/views/discover/table/topResultsIndicator.tsx":(e,t,i)=>{i.d(t,{C:()=>a});const a=(0,i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"ex85xd30"})("position:absolute;left:-1px;margin-top:4.5px;width:9px;height:15px;border-radius:0 3px 3px 0;background-color:",(e=>e.theme.charts.getColorPalette(e.count-2)[e.index]),";")},"./app/views/starfish/components/miniChartPanel.tsx":(e,t,i)=>{i.d(t,{Z:()=>d});var a=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(i("../node_modules/react/index.js"),i("./app/components/panels/index.tsx")),s=i("./app/styles/space.tsx"),o=i("./app/styles/text.tsx"),r=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{title:t,children:i,button:a}=e;return(0,r.tZ)(n.s_,{children:(0,r.BX)(m,{children:[(0,r.BX)(l,{children:[t&&(0,r.tZ)(p,{children:t}),a]}),i]})})}d.displayName="MiniChartPanel";const p=(0,a.Z)("p",{target:"e1mibtmj2"})((e=>e.theme.text.cardTitle),";"),l=(0,a.Z)("div",{target:"e1mibtmj1"})("padding:0 ",(0,s.D)(1)," ",(0,s.D)(1)," 0;min-height:24px;width:100%;display:flex;align-items:center;justify-content:space-between;"),m=(0,a.Z)("div",{target:"e1mibtmj0"})("padding:",(0,s.D)(1.5)," ",(0,s.D)(2),";",o.Z,";")},"./app/views/starfish/views/webServiceView/spanGroupBreakdownContainer.tsx":(e,t,i)=>{i.d(t,{_:()=>E});var a=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js")),s=i("../node_modules/moment/moment.js"),o=i.n(s),r=i("./app/components/panels/index.tsx"),d=i("./app/components/placeholder.tsx"),p=i("./app/styles/space.tsx"),l=i("./app/utils/queryClient.tsx"),m=i("./app/utils/usePageFilters.tsx"),c=i("./app/views/starfish/components/breakdownBar.tsx"),u=i("./app/views/starfish/utils/dates.tsx"),h=i("./app/views/starfish/utils/zeroFillSeries.tsx"),g=i("./app/views/starfish/views/webServiceView/queries.js"),x=i("../node_modules/react/index.js"),y=i("../node_modules/react-router/es/index.js"),v=i("../node_modules/query-string/index.js"),b=i("./app/components/checkbox.tsx"),f=i("./app/components/duration.tsx"),w=i("./app/components/textOverflow.tsx"),Z=i("./app/components/tooltip.tsx"),_=i("./app/locale.tsx"),j=i("./app/utils/dates.tsx"),D=i("./app/utils/discover/styles.tsx"),$=i("./app/utils/formatters.tsx"),q=i("./app/views/discover/table/topResultsIndicator.tsx"),T=i("./app/views/performance/landing/widgets/components/selectableList.tsx"),S=i("./app/views/starfish/components/chart.tsx"),C=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function k(e){let{tableData:t,totalCumulativeTime:i,topSeriesData:a,initialShowSeries:n}=e;const{selection:s}=(0,m.Z)(),[o,r]=(0,x.useState)(n);(0,x.useEffect)((()=>{r(n)}),[n]);const d=[];for(let e=0;e<a.length;e++){const t=a[e];o[e]&&d.push(t)}return(0,C.BX)(x.Fragment,{children:[(0,C.BX)(M,{children:[(0,C.tZ)(G,{children:(0,C.tZ)(O,{children:"p50 of Span Groups With Highest Cumulative Times"})}),(0,C.tZ)(S.Z,{statsPeriod:"24h",height:175,data:d,start:"",end:"",loading:!1,utc:!1,grid:{left:"0",right:"0",top:"8px",bottom:"0"},definedAxisTicks:6,stacked:!0,aggregateOutputFormat:"duration"})]}),(0,C.tZ)(N,{children:t.map(((e,a)=>{const n=o[a],d=e.group,{start:p,end:l,utc:m,period:u}=s.datetime,h=p&&l?{start:(0,j.v5)(p),end:(0,j.v5)(l),utc:m}:{statsPeriod:u};["span_operation","action","domain"].forEach((e=>{void 0!==d[e]&&null!==d[e]&&(h[e]=d[e])}));const g="other"===d.module?"/starfish/spans/":`/starfish/spans/?${v.stringify(h)}`;return(0,C.tZ)(P,{children:(0,C.BX)(B,{children:[(0,C.tZ)(L,{count:Math.max(t.length-1,1),index:a}),(0,C.tZ)(b.Z,{size:"sm",checked:n,onChange:()=>{const e=[...o];e[a]=!n,r(e)}}),(0,C.tZ)(F,{children:(0,C.tZ)(y.Link,{to:g,children:(0,C.tZ)(w.Z,{children:(0,c.An)(d.span_operation,d.action,d.domain)})})}),(0,C.tZ)(T.S$,{children:(0,C.tZ)(Z.u,{title:(0,_.t)("This group of spans account for %s of the cumulative time on your web service",(0,$.rl)(e.cumulativeTime/i,1)),containerDisplayMode:"block",position:"top",children:(0,C.tZ)(D.Hw,{children:(0,_._N)("[cumulativeTime] ([cumulativeTimePercentage])",{cumulativeTime:(0,C.tZ)(f.Z,{seconds:e.cumulativeTime/1e3,fixedDigits:1,abbreviation:!0}),cumulativeTimePercentage:(0,$.rl)(e.cumulativeTime/i,1)})})})})]})},`${d.span_operation}-${d.action}-${d.domain}`)}))})]})}k.displayName="SpanGroupBreakdown";const P=(0,a.Z)("li",{target:"e1sx7q3i7"})("line-height:",(e=>e.theme.text.lineHeightBody),";"),B=(0,a.Z)("div",{target:"e1sx7q3i6"})("display:flex;border-top:1px solid ",(e=>e.theme.border),";padding:",(0,p.D)(1)," ",(0,p.D)(2),";font-size:",(e=>e.theme.fontSizeMedium),";"),N=(0,a.Z)("ul",{target:"e1sx7q3i5"})("padding:",(0,p.D)(1)," 0 0 0;margin:0;list-style-type:none;"),F=(0,a.Z)("span",{target:"e1sx7q3i4"})("text-align:left;width:100%;padding:0 ",(0,p.D)(1.5),";"),M=(0,a.Z)("div",{target:"e1sx7q3i3"})("padding:0 ",(0,p.D)(2),";"),O=(0,a.Z)("p",{target:"e1sx7q3i2"})((e=>e.theme.text.cardTitle),";"),G=(0,a.Z)("div",{target:"e1sx7q3i1"})("padding:0 ",(0,p.D)(1)," 0 0;min-height:36px;width:100%;display:flex;align-items:center;justify-content:space-between;"),L=(0,a.Z)(q.C,{target:"e1sx7q3i0"})({name:"db9nhh",styles:"margin-top:0px"}),z="http://localhost:8080",A="other";function E(e){let{transaction:t}=e;const i=t??"",a=(0,m.Z)(),{selection:s}=a,p=(0,n.u)(),{data:x,isLoading:y}=(0,l.aM)({queryKey:["webServiceSpanGrouping",i,s.datetime],queryFn:()=>fetch(`${z}/?query=${(0,g.u4)({transaction:i,datetime:s.datetime})}`).then((e=>e.json())),retry:!1,initialData:[]}),{data:v}=(0,l.aM)({queryKey:["totalCumulativeTime",i,s.datetime],queryFn:()=>fetch(`${z}/?query=${(0,g.hj)({transaction:i,datetime:s.datetime})}`).then((e=>e.json())),retry:!1,initialData:[]}),b=v.reduce(((e,t)=>e+t.sum),0),f=b-x.reduce(((e,t)=>e+t.sum),0),w=[];for(let e=0;e<x.length;e++){const t=x[e];w.push({cumulativeTime:t.sum,group:{action:t.action,domain:t.domain,module:t.module,span_operation:t.span_operation,transaction:t.transaction}})}w.push({cumulativeTime:f,group:{action:"",domain:"",module:A,span_operation:"Other",transaction:""}});let Z=x.length>0?` (span_operation = '${x[0].span_operation}' ${x[0].action?`AND action = '${x[0].action}'`:""} ${x[0].domain?`AND domain = '${x[0].domain}'`:""})`:"";for(let e=1;e<x.length;e++){const t=x[e];Z=Z.concat(" OR ",`(span_operation = '${t.span_operation}' ${t.action?`AND action = '${t.action}'`:""} ${t.domain?`AND domain = '${t.domain}'`:""})`)}const{isLoading:_,data:j}=(0,l.aM)({queryKey:["topSpanGroupTimeseries",i,Z,s.datetime],queryFn:()=>fetch(`${z}/?query=${(0,g.Lb)({transaction:i,topConditions:Z,datetime:s.datetime})}`).then((e=>e.json())),retry:!1,initialData:[]}),{isLoading:D,data:$}=(0,l.aM)({queryKey:["otherSpanGroupTimeseries",i,Z,s.datetime],queryFn:()=>fetch(`${z}/?query=${(0,g.Sy)({transaction:i,topConditions:Z,datetime:s.datetime})}`).then((e=>e.json())),retry:!1,initialData:[]}),q={},[T,S,P]=a.selection.datetime.period?.match(u.Pr)??[],B=S&&P?o()().subtract(S,P):o()(a.selection.datetime.start),N=o()(a.selection.datetime.end??void 0),F=p.charts.getColorPalette(w.length-3);!_&&!D&&x.length>0&&(x.forEach(((e,t)=>{const i=(0,c.c_)(e.span_operation,e.action,e.domain);q[i]={seriesName:`${i}`,data:[],color:F[t]}})),j.forEach((e=>{q[(0,c.c_)(e.span_operation,e.action,e.domain)].data.push({value:e.p50,name:e.interval})})),q.Other={seriesName:"Other",data:[],color:p.gray100},$.forEach((e=>{q.Other.data.push({value:e.p50,name:e.interval})})));const M=Object.values(q).map((e=>(0,h.b)(e,o().duration(12,"hour"),B,N))),O=w.map((e=>e.group.module!==A));return _||y?(0,C.tZ)(r.s_,{children:(0,C.tZ)(d.Z,{height:"600px"})}):(0,C.tZ)(X,{children:(0,C.tZ)(k,{tableData:w,totalCumulativeTime:b,isTableLoading:y,topSeriesData:M,colorPalette:F,initialShowSeries:O})})}E.displayName="SpanGroupBreakdownContainer";const X=(0,a.Z)(r.s_,{target:"eoo99dh0"})("padding-top:",(0,p.D)(2),";margin-bottom:0;")}}]);
//# sourceMappingURL=../sourcemaps/app_components_performance_layouts_index_tsx-app_views_starfish_components_miniChartPanel_tsx-1951a7.956eaa61ffa37af27db0d4ba6c497428.js.map