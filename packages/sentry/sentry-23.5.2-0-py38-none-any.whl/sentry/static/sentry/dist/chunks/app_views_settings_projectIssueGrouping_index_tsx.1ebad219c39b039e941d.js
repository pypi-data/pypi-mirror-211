"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_projectIssueGrouping_index_tsx"],{"./app/utils/routeTitle.tsx":(e,t,n)=>{n.d(t,{Z:()=>s});const s=function(e,t){let n=arguments.length>3?arguments[3]:void 0;const s=`${e} - ${t}`,i=n?`${s} - ${n}`:s;return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?i:`${i} - Sentry`}},"./app/views/asyncView.tsx":(e,t,n)=>{n.d(t,{Z:()=>o});var s=n("./app/components/asyncComponent.tsx"),i=n("./app/components/sentryDocumentTitle.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class o extends s.Z{getTitle(){return""}render(){return(0,r.tZ)(i.Z,{title:this.getTitle(),children:this.renderComponent()})}}o.displayName="AsyncView"},"./app/views/settings/project/permissionAlert.tsx":(e,t,n)=>{n.d(t,{Z:()=>p});var s=n("./app/components/acl/access.tsx"),i=n("./app/components/alert.tsx"),r=n("./app/locale.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{access:t=["project:write"],project:n,team:a,...p}=e;return(0,o.tZ)(s.Z,{access:t,project:n,team:a,children:e=>{let{hasAccess:t}=e;return!t&&(0,o.tZ)(i.bZ,{"data-test-id":"project-permission-alert",type:"warning",...p,children:(0,r.t)("These settings can only be edited by users with the organization-level owner, manager, or team-level admin roles.")})}})}a.displayName="PermissionAlert";const p=a},"./app/views/settings/projectIssueGrouping/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=n("../node_modules/react/index.js"),r=n("./app/components/acl/access.tsx"),o=n("./app/components/acl/feature.tsx"),a=n("./app/components/forms/form.tsx"),p=n("./app/components/forms/jsonForm.tsx"),c=n("./app/components/links/externalLink.tsx"),l=n("./app/data/forms/projectIssueGrouping.tsx"),g=n("./app/locale.tsx"),u=n("./app/stores/projectsStore.tsx"),d=n("./app/utils/routeTitle.tsx"),h=n("./app/views/asyncView.tsx"),m=n("./app/views/settings/components/settingsPageHeader.tsx"),f=n("./app/views/settings/components/text/textBlock.tsx"),Z=n("./app/views/settings/project/permissionAlert.tsx"),x=n("./app/actionCreators/indicator.tsx"),y=n("./app/components/alert.tsx"),w=n("./app/components/button.tsx"),j=n("./app/components/confirm.tsx"),b=n("./app/components/forms/fieldGroup/index.tsx"),v=n("./app/components/panels/index.tsx"),k=n("./app/utils/handleXhrErrorResponse.tsx"),C=n("./app/utils/marked.tsx"),T=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const G="upgrade-grouping";function U(e){let{groupingConfigs:t,organization:n,projectId:s,project:r,onUpgrade:o,api:a,location:p}=e;const c=n.access.includes("project:write"),{updateNotes:l,riskLevel:d,latestGroupingConfig:h}=function(e,t){const n={};let s="",i=0,r=null;if(t.forEach((t=>{n[t.id]=t,t.latest&&e.groupingConfig!==t.id&&(s=t.changelog,r=t,i=t.risk)})),r){let t=r.base??"";for(;t!==e.groupingConfig;){const e=n[t];if(!e)break;i=Math.max(i,e.risk),s=e.changelog+"\n"+s,t=e.base??""}}return{updateNotes:s,riskLevel:i,latestGroupingConfig:r}}(r,t),{riskNote:m,alertType:Z}=function(e){switch(e){case 0:return{riskNote:(0,g.t)("This upgrade has the chance to create some new issues."),alertType:"info"};case 1:return{riskNote:(0,g.t)("This upgrade will create some new issues."),alertType:"warning"};case 2:return{riskNote:(0,T.tZ)("strong",{children:(0,g.t)("The new grouping strategy is incompatible with the current and will create entirely new issues.")}),alertType:"error"};default:return{riskNote:void 0,alertType:void 0}}}(d),U=r.groupingAutoUpdate||!h,S=d>=2?"danger":"primary";if((0,i.useEffect)((()=>{p.hash===`#${G}`&&!U&&t&&c&&N()}),[p.hash]),!t)return null;async function _(){const e={};if(h){const t=Math.floor((new Date).getTime()/1e3),n=7776e3;e.groupingConfig=h.id,e.secondaryGroupingConfig=r.groupingConfig,e.secondaryGroupingExpiry=t+n}(0,x.E3)((0,g.t)("Changing groupingâ€¦"));try{const t=await a.requestPromise(`/projects/${n.slug}/${s}/`,{method:"PUT",data:e});(0,x.B8)(),u.Z.onUpdateSuccess(t),o()}catch(e){(0,k.X)((0,g.t)("Unable to upgrade config"),e)}}function N(){(0,j._)({confirmText:(0,g.t)("Upgrade"),priority:S,onConfirm:_,message:(0,T.BX)(i.Fragment,{children:[(0,T.tZ)(f.Z,{children:(0,T.tZ)("strong",{children:(0,g.t)("Upgrade Grouping Strategy")})}),(0,T.tZ)(f.Z,{children:(0,g.t)("You can upgrade the grouping strategy to the latest but this is an irreversible operation.")}),(0,T.BX)(f.Z,{children:[(0,T.tZ)("strong",{children:(0,g.t)("New Behavior")}),(0,T.tZ)("div",{dangerouslySetInnerHTML:{__html:(0,C.Z)(l)}})]}),(0,T.tZ)(f.Z,{children:(0,T.tZ)(y.bZ,{type:Z,children:m})})]})})}return(0,T.BX)(v.s_,{id:G,children:[(0,T.tZ)(v.V9,{children:(0,g.t)("Upgrade Grouping")}),(0,T.tZ)(v.N,{children:(0,T.tZ)(b.Z,{label:(0,g.t)("Upgrade Grouping Strategy"),help:(0,g._N)("If the project uses an old grouping strategy an update is possible.[linebreak]Doing so will cause new events to group differently.",{linebreak:(0,T.tZ)("br",{})}),disabled:!0,children:(0,T.tZ)("div",{children:(0,T.tZ)(w.zx,{onClick:N,disabled:!c||U,title:r.groupingAutoUpdate?(0,g.t)("Disabled because automatic upgrading is enabled"):c?U?(0,g.t)("You are already on the latest version"):void 0:(0,g.t)("You do not have sufficient permissions to do this"),priority:S,children:(0,g.t)("Upgrade Grouping Strategy")})})})})]})}U.displayName="UpgradeGrouping";const S=U;class _ extends h.Z{constructor(){super(...arguments),(0,s.Z)(this,"handleSubmit",(e=>{u.Z.onUpdateSuccess(e)}))}getTitle(){const{projectId:e}=this.props.params;return(0,d.Z)((0,g.t)("Issue Grouping"),e,!1)}getDefaultState(){return{...super.getDefaultState(),groupingConfigs:[]}}getEndpoints(){const{organization:e,project:t}=this.props;return[["groupingConfigs",`/projects/${e.slug}/${t.slug}/grouping-configs/`]]}renderBody(){const{groupingConfigs:e}=this.state,{organization:t,project:n,params:s,location:u}=this.props,d=`/projects/${t.slug}/${n.slug}/`,h=new Set(t.access.concat(n.access)),x=(0,r.d)(["project:write"],{organization:t,project:n}),y={additionalFieldProps:{organization:t,groupingConfigs:e},features:new Set(t.features),access:h,disabled:!x};return(0,T.BX)(i.Fragment,{children:[(0,T.tZ)(m.Z,{title:(0,g.t)("Issue Grouping")}),(0,T.tZ)(f.Z,{children:(0,g._N)("All events have a fingerprint. Events with the same fingerprint are grouped together into an issue. To learn more about issue grouping, [link: read the docs].",{link:(0,T.tZ)(c.Z,{href:"https://docs.sentry.io/product/data-management-settings/event-grouping/"})})}),(0,T.tZ)(Z.Z,{project:n}),(0,T.BX)(a.Z,{saveOnBlur:!0,allowUndo:!0,initialData:n,apiMethod:"PUT",apiEndpoint:d,onSubmitSuccess:this.handleSubmit,children:[(0,T.tZ)(p.Z,{...y,title:(0,g.t)("Fingerprint Rules"),fields:[l.fields.fingerprintingRules]}),(0,T.tZ)(p.Z,{...y,title:(0,g.t)("Stack Trace Rules"),fields:[l.fields.groupingEnhancements]}),(0,T.tZ)(o.Z,{features:["set-grouping-config"],organization:t,children:(0,T.tZ)(p.Z,{...y,title:(0,g.t)("Change defaults"),fields:[l.fields.groupingConfig,l.fields.secondaryGroupingConfig,l.fields.secondaryGroupingExpiry]})}),(0,T.tZ)(p.Z,{...y,title:(0,g.t)("Automatic Grouping Updates"),fields:[l.fields.groupingAutoUpdate]}),(0,T.tZ)(S,{groupingConfigs:e??[],organization:t,projectId:s.projectId,project:n,api:this.api,onUpgrade:this.fetchData,location:u})]})]})}}const N=_}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_projectIssueGrouping_index_tsx.3287a88b2fe60882084a52dfbcdd6a12.js.map