"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_starfish_views_webServiceView_index_tsx"],{"./app/components/charts/components/markArea.tsx":(t,e,r)=>{function a(t){return{...t}}r.d(e,{Z:()=>a}),r("../node_modules/echarts/lib/component/markArea.js")},"./app/utils/performance/contexts/pageError.tsx":(t,e,r)=>{r.d(e,{De:()=>d,V_:()=>o,YY:()=>l});var a=r("../node_modules/react/index.js"),n=r("./app/components/alert.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const s=(0,a.createContext)({pageError:void 0,setPageError:t=>{}});function o(t){let{children:e}=t;const[r,n]=(0,a.useState)();return(0,i.tZ)(s.Provider,{value:{pageError:r,setPageError:n},children:e})}function l(){const{pageError:t}=(0,a.useContext)(s);return t?(0,i.tZ)(n.bZ,{type:"error","data-test-id":"page-error-alert",showIcon:!0,children:t}):null}o.displayName="PageErrorProvider",l.displayName="PageErrorAlert";const d=()=>(0,a.useContext)(s)},"./app/utils/useKeyPress.tsx":(t,e,r)=>{r.d(e,{Z:()=>n});var a=r("../node_modules/react/index.js");const n=(t,e)=>{const[r,n]=(0,a.useState)(!1),i=e??document.body;return(0,a.useEffect)((()=>{const e=e=>{let{key:r}=e;r===t&&n(!0)},r=e=>{let{key:r}=e;r===t&&n(!1)};return i.addEventListener("keydown",e),i.addEventListener("keyup",r),()=>{i.removeEventListener("keydown",e),i.removeEventListener("keyup",r)}}),[t,i]),r}},"./app/views/starfish/components/detailPanel.tsx":(t,e,r)=>{r.d(e,{Z:()=>v});var a=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=r("../node_modules/react/index.js"),i=r("./app/components/button.tsx"),s=r("./app/icons/iconClose.tsx"),o=r("./app/locale.tsx"),l=r("./app/styles/space.tsx"),d=r("./app/utils/useKeyPress.tsx"),c=r("./app/utils/useOnClickOutside.tsx"),p=r("../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),u=r("../node_modules/framer-motion/dist/es/render/dom/motion.mjs"),m=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const h="50vw",g=(0,n.forwardRef)(f);function f(t,e){let{collapsed:r,children:a}=t;return(0,m.tZ)(y,{ref:e,collapsed:r,initial:{opacity:0,x:h},animate:r?{opacity:0,x:h}:{opacity:1,x:0},transition:{type:"spring",stiffness:500,damping:50},children:a})}f.displayName="SlideOverPanel";const y=(0,a.Z)(u.E.div,{shouldForwardProp:t=>["animate","transition","initial"].includes(t)||"collapsed"!==t&&(0,p.Z)(t),target:"e1iwvxg00"})("width:",h,";position:fixed;top:0;bottom:0;right:0;background:",(t=>t.theme.background),";color:",(t=>t.theme.textColor),";border-left:1px solid ",(t=>t.theme.border),";text-align:left;z-index:",(t=>t.theme.zIndex.sidebar-1),";",(t=>t.collapsed?"overflow: hidden;":"overflow-x: hidden;\n  overflow-y: scroll;"),";");function v(t){let{children:e,detailKey:r,onClose:a}=t;const[i,l]=(0,n.useState)({collapsed:!0}),p=(0,d.Z)("Escape");(0,n.useEffect)((()=>{r&&l({collapsed:!1})}),[r]);const u=(0,n.useRef)(null);return(0,c.Z)(u,(()=>{i.collapsed||(a?.(),l({collapsed:!0}))})),(0,n.useEffect)((()=>{p&&(i.collapsed||(a?.(),l({collapsed:!0})))}),[p]),(0,m.BX)(g,{collapsed:i.collapsed,ref:u,children:[(0,m.tZ)(Z,{children:(0,m.tZ)(x,{priority:"link",size:"zero",borderless:!0,"aria-label":(0,o.t)("Close Details"),icon:(0,m.tZ)(s.b,{size:"sm"}),onClick:()=>{l({collapsed:!0}),a?.()}})}),(0,m.tZ)(w,{children:e})]})}v.displayName="Detail";const x=(0,a.Z)(i.zx,{target:"e1clb2dw2"})("color:",(t=>t.theme.gray300),";&:hover{color:",(t=>t.theme.gray400),";}"),Z=(0,a.Z)("div",{target:"e1clb2dw1"})("justify-content:flex-end;display:flex;padding:",(0,l.D)(2),";"),w=(0,a.Z)("div",{target:"e1clb2dw0"})("padding:0 ",(0,l.D)(4),";")},"./app/views/starfish/views/webServiceView/index.tsx":(t,e,r)=>{r.r(e),r.d(e,{default:()=>Ht});var a=r("../node_modules/react/index.js"),n=r("../node_modules/lodash/isEqual.js"),i=r.n(n),s=r("./app/actionCreators/tags.tsx"),o=r("./app/components/organizations/pageFilters/container.tsx"),l=r("./app/components/sentryDocumentTitle.tsx"),d=r("./app/locale.tsx"),c=r("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),p=r("./app/utils/useApi.tsx"),u=r("./app/utils/useOrganization.tsx"),m=r("./app/utils/usePrevious.tsx"),h=r("./app/utils/useProjects.tsx"),g=r("./app/utils/withPageFilters.tsx"),f=r("../node_modules/lodash/trimStart.js"),y=r.n(f),v=r("./app/components/gridEditable/index.tsx"),x=r("./app/components/performance/searchBar.tsx"),Z=r("./app/utils/discover/eventView.tsx"),w=(r("./app/utils/performance/vitals/constants.tsx"),r("./app/utils/queryString.tsx")),b=r("./app/utils/tokenizeSearch.tsx"),_=(r("./app/views/performance/trends/utils.tsx"),r("./app/views/starfish/utils/dates.tsx"));const q=["transaction"],k="equation|sum(transaction.duration) / total.transaction_duration",T=t=>t?.features?.includes("performance-landing-page-stats-period")?"14d":"7d";var E=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),S=r("./app/components/datePageFilter.tsx"),P=r("./app/components/layouts/thirds.tsx"),D=r("./app/components/organizations/pageFilterBar.tsx"),C=r("./app/components/projectPageFilter.tsx"),j=r("./app/styles/space.tsx"),L=r("./app/utils/performance/contexts/pageError.tsx"),z=r("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),B=r("../node_modules/lodash/isNil.js"),O=r.n(B),A=r("../node_modules/query-string/index.js"),F=r("./app/components/button.tsx"),N=r("./app/components/charts/eventsRequest.tsx"),X=r("./app/utils/formatters.tsx"),$=r("./app/utils/withApi.tsx"),Y=r("./app/views/starfish/components/chart.tsx"),V=r("./app/views/starfish/components/detailPanel.tsx"),M=r("./app/views/starfish/views/webServiceView/spanGroupBreakdownContainer.tsx"),R=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const W=(0,$.Z)(N.Z);function U(t){let{row:e,onClose:r,eventView:a,organization:n,location:i}=t;return O()(e)?null:(0,R.tZ)(V.Z,{detailKey:e?.endpoint,onClose:r,children:e&&a&&n&&i&&(0,R.tZ)(I,{row:e,eventView:a,organization:n,location:i})})}function I(t){let{row:e,eventView:r,organization:n}=t;const i=(0,z.u)(),{aggregateDetails:s,transaction:o,httpOp:l}=e,c=new b.MY(["has:http.method","transaction.op:http.server",`transaction:${o}`,`http.method:${l}`]);return(0,R.BX)("div",{children:[(0,R.tZ)("h2",{children:(0,d.t)("Endpoint Detail")}),(0,R.tZ)("p",{children:(0,d.t)("Details of endpoint. More breakdowns, etc. Maybe some trends?")}),(0,R.tZ)(J,{to:`/organizations/${n.slug}/starfish/endpoint-overview/?${A.stringify({endpoint:o,method:l,statsPeriod:r.statsPeriod,project:r.project,start:r.start,end:r.end})}`,children:(0,d.t)("Go to Endpoint Overview")}),(0,R.tZ)(G,{children:(0,d.t)("Endpoint URL")}),(0,R.tZ)("pre",{children:e?.endpoint}),(0,R.tZ)(W,{query:c.formatString(),includePrevious:!1,partial:!0,limit:5,interval:"1h",includeTransformedData:!0,environment:r.environment,project:r.project,period:r.statsPeriod,referrer:"starfish-homepage-count",start:r.start,end:r.end,organization:n,yAxis:["tpm()","p50(transaction.duration)"],queryExtras:{dataset:"metrics"},children:t=>{let{results:e,loading:r}=t;return(0,R.tZ)(a.Fragment,{children:(0,R.BX)(K,{children:[(0,R.BX)(H,{children:[(0,R.tZ)(G,{children:(0,d.t)("Throughput")}),(0,R.tZ)(Q,{children:(0,X.Du)(s.tpm)}),(0,R.tZ)(Y.Z,{statsPeriod:"24h",height:110,data:e?.[0]?[e?.[0]]:[],start:"",end:"",loading:r,utc:!1,stacked:!0,isLineChart:!0,disableXAxis:!0,hideYAxisSplitLine:!0,chartColors:[i.charts.getColorPalette(0)[0]],grid:{left:"0",right:"0",top:"8px",bottom:"16px"}})]}),(0,R.BX)(H,{children:[(0,R.tZ)(G,{children:(0,d.t)("p50(duration)")}),(0,R.tZ)(Q,{children:(0,X.g9)(s.p50/1e3,0,!0)}),(0,R.tZ)(Y.Z,{statsPeriod:"24h",height:110,data:e?.[1]?[e?.[1]]:[],start:"",end:"",loading:r,utc:!1,stacked:!0,isLineChart:!0,disableXAxis:!0,hideYAxisSplitLine:!0,chartColors:[i.charts.getColorPalette(0)[1]],grid:{left:"0",right:"0",top:"8px",bottom:"16px"}})]})]})})}}),(0,R.tZ)(M._,{transaction:e.transaction})]})}U.displayName="EndpointDetail",I.displayName="EndpointDetailBody";const G=(0,E.Z)("h3",{target:"e147b3ya4"})("color:",(t=>t.theme.gray300),";font-size:",(t=>t.theme.fontSizeLarge),";margin:0;margin-bottom:",(0,j.D)(1),";"),Q=(0,E.Z)("h4",{target:"e147b3ya3"})({name:"3in70x",styles:"margin:0;font-weight:normal"}),K=(0,E.Z)("div",{target:"e147b3ya2"})("display:flex;&>div:last-child{padding-right:",(0,j.D)(1),";}"),H=(0,E.Z)("div",{target:"e147b3ya1"})("padding-right:",(0,j.D)(4),";flex:1;"),J=(0,E.Z)(F.zx,{target:"e147b3ya0"})("margin-bottom:",(0,j.D)(2),";");var tt=r("./app/components/performance/layouts/index.tsx"),et=r("./app/constants/chartPalette.tsx"),rt=r("./app/utils/queryClient.tsx"),at=r("./app/utils/usePageFilters.tsx"),nt=r("./app/views/starfish/components/miniChartPanel.tsx"),it=(r("../node_modules/core-js/modules/es.array.push.js"),r("./app/components/charts/components/markArea.tsx"));var st=r("../node_modules/moment/moment.js"),ot=r.n(st),lt=r("./app/components/charts/styles.tsx"),dt=r("./app/constants/index.tsx"),ct=r("./app/utils/discover/discoverQuery.tsx"),pt=r("./app/utils/useLocation.tsx"),ut=r("./app/components/links/link.tsx"),mt=r("./app/components/pagination.tsx"),ht=r("./app/utils/discover/fieldRenderers.tsx");const gt=[{key:"transaction",name:"endpoint",width:350},{key:"count_if(http.status_code,greaterOrEquals,500)",name:"Errors",width:50},{key:"equation|count_if(http.status_code,greaterOrEquals,500)/(count_if(http.status_code,equals,200)+count_if(http.status_code,greaterOrEquals,500))",name:"Error Rate",width:50}];function ft(t){let{location:e,organization:r,eventView:n,isLoading:i,tableData:s,pageLinks:o}=t;return(0,R.BX)(a.Fragment,{children:[(0,R.tZ)(v.ZP,{isLoading:i,data:s?s.data:[],columnOrder:gt,columnSortBy:n.getSorts(),grid:{renderHeadCell:function(t){return(0,R.tZ)(yt,{align:"left",children:t.name})},renderBodyCell:(t,a)=>function(t,a,n){if(!s||!s.meta)return a[t.key];const i=String(t.key),o=(0,ht.Js)(i,s.meta,!1)(a,{organization:r,location:e});if("transaction"===t.key){const t=a["http.method"]?`${a["http.method"]} `:"";return(0,R.BX)(ut.Z,{to:{pathname:`/starfish/failure-detail/${a["http.method"]}:${encodeURIComponent(a.transaction)}`,query:{start:e.query.start,end:e.query.end}},children:[t,a.transaction]})}return o}(t,a)},location:e}),(0,R.tZ)(mt.Z,{pageLinks:o})]})}ft.displayName="FailureDetailTable";const yt=(0,E.Z)("div",{target:"elb0pee0"})("display:block;width:100%;white-space:nowrap;",(t=>t.align?`text-align: ${t.align};`:""),";");var vt=r("./app/components/charts/lineChart.tsx"),xt=r("./app/utils/discover/charts.tsx");function Zt(t){let{data:e,spike:r}=t;const a=(0,z.u)(),n=a.red300,i=1e7;if(!e||e.length<=0||!r)return null;const s=[{color:n,data:e[0].data.filter((t=>r?.startTimestamp-i<=parseInt(t.name,10)&&parseInt(t.name,10)<=r?.endTimestamp+i)),seriesName:"Failure Rate"},{seriesName:"Focused Area",color:n,data:[],silent:!1,emphasis:{disabled:!1},markArea:(0,it.Z)({silent:!0,itemStyle:{color:n,opacity:.2},label:{show:!1},data:[[{name:"start",xAxis:r.startTimestamp,emphasis:{disabled:!1}},{name:"end",xAxis:r.endTimestamp,emphasis:{disabled:!1}}]]})}],o={splitNumber:3,type:"value",axisLabel:{color:a.chartLabel,formatter:t=>(0,X.rl)(t,1)}},l={seriesOptions:{showSymbol:!1},isGroupedByDate:!0,showTimeInTooltip:!0,color:n,tooltip:{trigger:"axis",valueFormatter:t=>(0,xt.CX)(t,"percentage")},xAxis:{show:!1}};return(0,R.tZ)(vt.w,{height:120,series:s,yAxis:o,...l})}Zt.displayName="FocusedFailureRateChart";const wt=Zt;var bt=r("./app/utils/discover/fields.tsx");function _t(t){let{organization:e,location:r,spike:n,transactions:i}=t;const s=[{key:"issue",name:"Issue",width:120},{key:"title",name:"Title",width:280},{key:"count_unique(user)",name:"Users",width:50},{key:"count()",name:"Count",width:50}];let o="event.type:error transaction:[";i?.forEach((t=>o+=`${t},`)),o=o.slice(0,o.length-1)+"]";const{query:l}=r,c=n?.startTimestamp&&n.endTimestamp,p={name:(0,d.t)("Failure Detail Issues"),projects:[],start:n?.startTimestamp?new Date(n?.startTimestamp).toUTCString():void 0,end:n?.endTimestamp?new Date(n?.endTimestamp).toUTCString():void 0,range:c?void 0:(0,w.ro)(l.statsPeriod)||dt.GY,fields:["issue","title","count()","count_unique(user)"],query:o,orderby:`-${(0,bt.LY)("count()")}`,version:2},u=Z.ZP.fromNewQueryWithLocation(p,r);return i?(0,R.tZ)(ct.Z,{eventView:u,orgSlug:e.slug,location:r,referrer:"api.starfish.failure-issue-list",queryExtras:{dataset:"discover"},limit:5,children:t=>{let{pageLinks:n,isLoading:i,tableData:o}=t;return(0,R.BX)(a.Fragment,{children:[(0,R.tZ)(v.ZP,{isLoading:i,data:o?o.data:[],columnOrder:s,columnSortBy:u.getSorts(),grid:{renderHeadCell:t=>function(t,e){const r=(0,bt.qG)(e.name,e.type,t);return(0,R.tZ)(qt,{align:r,children:e.name})}(o?.meta,t),renderBodyCell:(t,a)=>function(t,a,n,i){if(!t||!t.meta)return n[a.key];const s=String(a.key);return(0,ht.Js)(s,t.meta,!1)(n,{organization:e,location:r})}(o,t,a)},location:r}),(0,R.tZ)(mt.Z,{pageLinks:n})]})}}):(0,R.tZ)(v.ZP,{isLoading:!0,data:[],columnOrder:s,columnSortBy:u.getSorts(),grid:{},location:r})}_t.displayName="IssueTable";const qt=(0,E.Z)("div",{target:"e1985awp0"})("display:block;width:100%;white-space:nowrap;",(t=>t.align?`text-align: ${t.align};`:""),";");function kt(t){let{chartData:e,spike:r,onClose:n}=t;const i=(0,pt.T)(),s=(0,u.Z)();if(O()(r))return null;const o=r?.startTimestamp&&r.endTimestamp;function l(){const t={name:(0,d.t)("Transaction Event Count"),projects:[],start:r?.startTimestamp?new Date(r?.startTimestamp).toUTCString():void 0,end:r?.endTimestamp?new Date(r?.endTimestamp).toUTCString():void 0,range:o?void 0:(0,w.ro)(i.query.statsPeriod)||dt.GY,fields:["count_if(http.status_code,greaterOrEquals,500)"],query:"event.type:transaction",version:2},e={name:(0,d.t)("Error Event Count"),projects:[],start:r?.startTimestamp?new Date(r?.startTimestamp).toUTCString():void 0,end:r?.endTimestamp?new Date(r?.endTimestamp).toUTCString():void 0,range:o?void 0:(0,w.ro)(i.query.statsPeriod)||dt.GY,fields:["count()"],query:"event.type:error",version:2};return(0,R.BX)(St,{children:[(0,R.BX)(Pt,{children:[(0,R.tZ)(lt.OT,{children:(0,d.t)("Transaction Events")}),(0,R.tZ)(ct.Z,{eventView:Z.ZP.fromNewQueryWithLocation(t,i),orgSlug:s.slug,location:i,referrer:"api.starfish.failure-event-list",queryExtras:{dataset:"discover"},children:t=>{let{isLoading:e,tableData:r}=t;return(0,R.tZ)(Dt,{children:e?"—":r?.data[0]["count_if(http.status_code,greaterOrEquals,500)"]})}})]}),(0,R.BX)(Pt,{children:[(0,R.tZ)(lt.OT,{children:(0,d.t)("Error Events")}),(0,R.tZ)(ct.Z,{eventView:Z.ZP.fromNewQueryWithLocation(e,i),orgSlug:s.slug,location:i,referrer:"api.starfish.failure-event-list",queryExtras:{dataset:"discover"},children:t=>{let{isLoading:e,tableData:r}=t;return(0,R.tZ)(Dt,{children:e?"—":r?.data[0]["count()"]})}})]}),(0,R.BX)(Pt,{children:[(0,R.tZ)(lt.OT,{children:(0,d.t)("Users")}),(0,R.tZ)(Dt,{children:"—"})]})]})}const c={name:(0,d.t)("Failure Sample"),projects:[],start:r?.startTimestamp?new Date(r?.startTimestamp).toUTCString():void 0,end:r?.endTimestamp?new Date(r?.endTimestamp).toUTCString():void 0,range:o?void 0:(0,w.ro)(i.query.statsPeriod)||dt.GY,fields:["transaction","count_if(http.status_code,greaterOrEquals,500)","equation|count_if(http.status_code,greaterOrEquals,500)/(count_if(http.status_code,equals,200)+count_if(http.status_code,greaterOrEquals,500))","http.method","count_if(http.status_code,equals,200)"],query:"event.type:transaction has:http.method transaction.op:http.server count_if(http.status_code,greaterOrEquals,500):>0",version:2,orderby:"-count_if_http_status_code_greaterOrEquals_500"},p=Z.ZP.fromNewQueryWithLocation(c,i);return(0,R.BX)(V.Z,{detailKey:r?.startTimestamp.toString(),onClose:n,children:[(0,R.tZ)(Et,{children:`${ot()(r?.startTimestamp).format("MMMM Do YYYY, h:mm:ss a")} - ${ot()(r?.endTimestamp).format("MMMM Do YYYY, h:mm:ss a")}`}),(0,R.tZ)("h4",{children:(0,d.t)("Error Spike Detail")}),r&&(0,R.tZ)(ct.Z,{eventView:p,orgSlug:s.slug,location:i,referrer:"api.starfish.failure-event-list",queryExtras:{dataset:"discover"},limit:5,children:t=>{const n=t?.tableData?.data.map((t=>t.transaction));return(0,R.BX)(a.Fragment,{children:[l(),(0,R.tZ)(wt,{data:e,spike:r}),(0,R.tZ)(Tt,{children:(0,d.t)("Failing Endpoints")}),(0,R.tZ)(ft,{...t,location:i,organization:s,eventView:p}),(0,R.tZ)(Tt,{children:(0,d.t)("Related Issues")}),(0,R.tZ)(_t,{location:i,organization:s,isLoading:t.isLoading,spike:r,transactions:n})]})}})]})}kt.displayName="FailureDetailPanel";const Tt=(0,E.Z)("h5",{target:"e19lyfqb4"})("margin-bottom:",(0,j.D)(1),";"),Et=(0,E.Z)("div",{target:"e19lyfqb3"})("color:",(t=>t.theme.red300),";margin-bottom:",(0,j.D)(4),";"),St=(0,E.Z)("div",{target:"e19lyfqb2"})("display:flex;flex-direction:row;margin-bottom:",(0,j.D)(2),";"),Pt=(0,E.Z)("div",{target:"e19lyfqb1"})("display:flex;flex-direction:column;margin-right:",(0,j.D)(4),";margin-bottom:0;"),Dt=(0,E.Z)("div",{target:"e19lyfqb0"})({name:"kux9p6",styles:"font-weight:400;font-size:22px"});var Ct=r("./app/components/assistant/guideAnchor.tsx"),jt=r("./app/components/gridEditable/sortLink.tsx"),Lt=r("./app/components/tooltip.tsx"),zt=r("./app/components/duration.tsx"),Bt=r("./app/components/searchBar.tsx"),Ot=r("./app/utils/discover/styles.tsx");const At=["endpoint","tpm","p50(duration)","p95(duration)"],Ft={[k]:"percentage"};function Nt(t){let{eventView:e,location:r,organization:n,setError:i,columnTitles:s,dataset:o}=t;const[l,c]=(0,a.useState)([]),[p,u]=(0,a.useState)(e);function m(t){const a={};return t?.data?.[0]&&Object.keys(t.data[0]).forEach((t=>{t.startsWith("equation|(percentile_range(transaction.duration,0.50,lessOrEquals")&&(a["p50()"]=t)})),(a,i)=>function(t,a,i,s){if(!t||!t.meta)return i[a.key];const o={...t.meta,...Ft},l=String(a.key),c=(0,ht.Js)(l,o,!1)(i,{organization:n,location:r});if("transaction"===l){let t="";return i["http.method"]&&(t=`${i["http.method"]} `),(0,R.BX)(ut.Z,{to:`/organizations/${n.slug}/starfish/endpoint-overview/?${A.stringify({endpoint:i.transaction,method:i["http.method"],statsPeriod:e.statsPeriod,project:e.project,start:e.start,end:e.end})}`,style:{display:"block",width:"100%"},children:[t,i.transaction]})}if(l===k){const t=Number(i["sum(transaction.duration)"]),e=Number(i[k]);return(0,R.tZ)(Lt.u,{title:(0,d.t)("This endpoint accounts for %s of the cumulative time on your web service",(0,X.rl)(e)),containerDisplayMode:"block",position:"top",children:(0,R.tZ)(Ot.Hw,{children:(0,d._N)("[cumulativeTime] ([cumulativeTimePercentage])",{cumulativeTime:(0,R.tZ)(zt.Z,{seconds:t/1e3,fixedDigits:2,abbreviation:!0}),cumulativeTimePercentage:(0,X.rl)(e)})})})}if(l.startsWith("equation|(percentile_range(transaction.duration,0.50,lessOrEquals,")){const t=i[l],e=t<0?"good":t>0?"bad":"neutral";return(0,R.tZ)(Ot.Hw,{children:(0,R.tZ)($t,{trendDirection:e,children:(0,d._N)("[sign][delta]",{sign:t>=0?"+":"-",delta:(0,X.rl)(Math.abs(t),2)})})})}if("project"===l)return null;const p=(0,bt.LY)(l),u=i[p];return"integer"===o[p]&&"number"==typeof u&&u>999?(0,R.tZ)(Lt.u,{title:u.toLocaleString(),containerDisplayMode:"block",position:"right",children:c}):c}(t,a,i)}function h(t){const a=s??At;return(n,i)=>function(t,a,n){let i="left";i="equation"===a.column.kind?"right":(0,bt.qG)(a.name,a.type,t);const s={field:"equation"===a.column.kind?a.key:a.name,width:a.width},o={};t&&Object.keys(t).forEach((e=>{o[(0,bt.LY)(e)]=t[e]}));const l=e.sortForField(s,o),d=(0,Z.M3)(s,o),c=l?l.kind:void 0;return(0,R.tZ)(jt.Z,{align:i,title:n||s.field,direction:c,canSort:d,generateSortLink:function(){if(!t)return;const a=e.sortOnField(s,o).generateQueryStringObject();return{...r,query:{...r.query,sort:a.sort}}}})}(t,n,a[i])}function g(t,e){c((r=>r.map(((r,a)=>a===t?Number(e.width??v.z7):r))))}(0,a.useEffect)((()=>{u((t=>{const r=e.clone();return r.query=t.query,r}))}),[e]);const f=e.getColumns().filter((t=>!t.name.startsWith("count_miserable")&&!t.name.startsWith("percentile_range")&&"project_threshold_config"!==t.name&&"project"!==t.name&&"http.method"!==t.name&&"total.transaction_duration"!==t.name&&"sum(transaction.duration)"!==t.name)).map(((t,e)=>"number"==typeof l[e]?{...t,width:l[e]}:t)),y=e.getSorts();return(0,R.BX)(Ct.Z,{target:"performance_table",position:"top-start",children:[(0,R.tZ)(Yt,{placeholder:(0,d.t)("Search for endpoints"),onSearch:function(t){const r=e.clone();r.query+=`transaction:*${t}*`,u(r)}}),(0,R.tZ)(ct.Z,{eventView:p,orgSlug:n.slug,location:r,setError:t=>i(t?.message),referrer:"api.starfish.endpoint-list",queryExtras:{dataset:o??"metrics"},children:t=>{let{pageLinks:e,isLoading:n,tableData:i}=t;return(0,R.BX)(a.Fragment,{children:[(0,R.tZ)(v.ZP,{isLoading:n,data:i?i.data:[],columnOrder:f,columnSortBy:y,grid:{onResizeColumn:g,renderHeadCell:h(i?.meta),renderBodyCell:m(i)},location:r}),(0,R.tZ)(mt.Z,{pageLinks:e})]})}})]})}Nt.displayName="EndpointList";const Xt=Nt,$t=(0,E.Z)("div",{target:"e152i1y81"})("color:",(t=>"good"===t.trendDirection?t.theme.successText:"bad"===t.trendDirection?t.theme.errorText:t.theme.subText),";float:right;"),Yt=(0,E.Z)(Bt.Z,{target:"e152i1y80"})("margin-bottom:",(0,j.D)(2),";"),Vt=(0,$.Z)(N.Z);function Mt(t){const{organization:e,eventView:r,onSelect:n}=t,i=(0,z.u)(),[s,o]=(0,a.useState)(null),l=(0,at.Z)(),{selection:c}=l,{projects:p,environments:u}=c;return(0,rt.WE)([`/organizations/${e.slug}/events-starfish/`,{query:{environment:u,project:p.map((t=>String(t))),statsPeriod:"7d"}}],{staleTime:10}),(0,Y.K)(),(0,R.BX)("div",{"data-test-id":"starfish-view",children:[(0,R.tZ)(Rt,{minSize:200,children:(0,R.BX)(Wt,{children:[(0,R.tZ)(Ut,{children:(0,R.tZ)(M._,{})}),(0,R.BX)(It,{children:[(0,R.tZ)(nt.Z,{title:(0,d.t)("Error Rate"),children:function(){const t=new b.MY(["event.type:transaction"]);return(0,R.tZ)(Vt,{query:t.formatString(),includePrevious:!1,partial:!0,interval:"1h",includeTransformedData:!0,limit:1,environment:r.environment,project:r.project,period:r.statsPeriod,referrer:"starfish-homepage-failure-rate",start:r.start,end:r.end,organization:e,yAxis:"equation|count_if(http.status_code,greaterOrEquals,500)/(count_if(http.status_code,equals,200)+count_if(http.status_code,greaterOrEquals,500))",children:t=>{const e=t.timeseriesData?.map((t=>({data:t.data,seriesName:(0,d.t)("Error Rate"),color:et.$[5][3],silent:!0})));return e?(function(t,e){const{data:r}=t[0],a=function(t,e,r){const a=e-t,n=Math.round(a/40),i=[];let s=t;for(;s<e;){const t=[s,s+n-0];i.push(t),s+=n}return i}(r[0].name,r[r.length-1].name).map((t=>{let[e,r]=t;return[{name:"start",xAxis:e,emphasis:{disabled:!1}},{name:"end",xAxis:r,emphasis:{disabled:!1}}]}));t.push({seriesName:"Clickable Area",color:e,data:[],silent:!1,emphasis:{disabled:!1},markArea:(0,it.Z)({silent:!1,itemStyle:{color:e,opacity:0},label:{show:!1},emphasis:{disabled:!1,itemStyle:{opacity:.2}},data:a})})}(e,i.red300),(0,R.BX)(a.Fragment,{children:[(0,R.tZ)(kt,{onClose:()=>o(null),chartData:e,spike:s}),(0,R.tZ)(Y.Z,{statsPeriod:r.statsPeriod,height:80,data:e,start:r.start,end:r.end,loading:t.loading,utc:!1,grid:{left:"0",right:"0",top:"8px",bottom:"0"},definedAxisTicks:2,isLineChart:!0,chartColors:i.charts.getColorPalette(2),disableXAxis:!0,aggregateOutputFormat:"percentage",onClick:t=>{"markArea"===t.componentType&&o({startTimestamp:t.data.coord[0][0],endTimestamp:t.data.coord[1][0]})}})]})):null}})}()}),(0,R.tZ)(nt.Z,{title:(0,d.t)("Duration"),children:function(){const t=new b.MY(["event.type:transaction","has:http.method","transaction.op:http.server"]);return(0,R.tZ)(Vt,{query:t.formatString(),includePrevious:!1,partial:!0,interval:"1h",includeTransformedData:!0,limit:1,environment:r.environment,project:r.project,period:r.statsPeriod,referrer:"starfish-homepage-count",start:r.start,end:r.end,organization:e,yAxis:["p95(transaction.duration)","p50(transaction.duration)"],queryExtras:{dataset:"metrics"},children:t=>{let{loading:e,results:a}=t;const n=a?.map((t=>({data:t.data,seriesName:t.seriesName})));return n?(0,R.tZ)(Y.Z,{statsPeriod:r.statsPeriod,height:107,data:n,start:"",end:"",loading:e,utc:!1,grid:{left:"0",right:"0",top:"16px",bottom:"0"},definedAxisTicks:2,isLineChart:!0,chartColors:i.charts.getColorPalette(2),disableXAxis:!0,aggregateOutputFormat:"duration"}):null}})}()}),(0,R.tZ)(nt.Z,{title:(0,d.t)("Throughput"),children:function(){const t=new b.MY(["event.type:transaction","has:http.method","transaction.op:http.server"]);return(0,R.tZ)(Vt,{query:t.formatString(),includePrevious:!1,partial:!0,interval:"1h",includeTransformedData:!0,limit:1,environment:r.environment,project:r.project,period:r.statsPeriod,referrer:"starfish-homepage-count",start:r.start,end:r.end,organization:e,yAxis:"tpm()",queryExtras:{dataset:"metrics"},children:t=>{let{loading:e,timeseriesData:a}=t;const n=a?.map((t=>({data:t.data,seriesName:(0,d.t)("Throughput"),color:et.$[0][0]})));return n?(0,R.tZ)(Y.Z,{statsPeriod:r.statsPeriod,height:80,data:n,start:"",end:"",loading:e,utc:!1,grid:{left:"0",right:"0",top:"8px",bottom:"0"},definedAxisTicks:2,stacked:!0,chartColors:i.charts.getColorPalette(2),disableXAxis:!0}):null}})}()})]})]})}),(0,R.tZ)(Xt,{...t,setError:(0,L.De)().setPageError,dataset:"discover",onSelect:n,columnTitles:["endpoint","tpm","p50(duration)","p50 change","failure count","cumulative time"]})]})}Mt.displayName="StarfishView";const Rt=(0,E.Z)(tt.c,{target:"epbipxo3"})("margin-bottom:",(0,j.D)(2),";"),Wt=(0,E.Z)("div",{target:"epbipxo2"})("display:flex;flex-direction:row;flex-wrap:wrap;gap:",(0,j.D)(2),";"),Ut=(0,E.Z)("div",{target:"epbipxo1"})({name:"1189xqs",styles:"flex:2"}),It=(0,E.Z)("div",{target:"epbipxo0"})({name:"82a6rk",styles:"flex:1"});function Gt(t){const e=(0,R.BX)(D.Z,{condensed:!0,children:[(0,R.tZ)(C.Z,{}),(0,R.tZ)(S.Z,{alignDropdown:"left"})]}),[r,n]=(0,a.useState)({selectedRow:void 0}),{selectedRow:i}=r;return(0,R.tZ)(P.T3,{children:(0,R.BX)(L.V_,{children:[(0,R.tZ)(P.h4,{children:(0,R.tZ)(P.oB,{children:(0,R.tZ)(P.Dx,{children:(0,d.t)("Starfish")})})}),(0,R.tZ)(P.uT,{children:(0,R.BX)(P.or,{fullWidth:!0,children:[(0,R.tZ)(L.YY,{}),(0,R.BX)(a.Fragment,{children:[(0,R.tZ)(Qt,{children:e}),(0,R.tZ)(Mt,{...t,onSelect:t=>n({selectedRow:t})}),(0,R.tZ)(U,{row:i,onClose:()=>n({selectedRow:void 0}),eventView:t.eventView,organization:t.organization,location:t.location})]})]})})]})})}Gt.displayName="StarfishLanding";const Qt=(0,E.Z)("div",{target:"e160gsn70"})("display:grid;grid-template-rows:auto auto auto;gap:",(0,j.D)(2),";margin-bottom:",(0,j.D)(2),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){grid-template-rows:auto;grid-template-columns:auto 1fr auto;}");function Kt(t){let{selection:e,location:r,router:n}=t;const g=(0,p.Z)(),f=(0,u.Z)(),{projects:E}=(0,h.Z)(),S=(0,a.useRef)(!1),P=(0,m.Z)(e.datetime),D=(0,c.gp)(f),C=function(t,e){let{withStaticFilters:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;const{query:n}=t,i=n.start&&n.end,s=(0,_.ie)({start:(0,w.ro)(n.start),end:(0,w.ro)(n.end),statsPeriod:n.statsPeriod||i?(0,w.ro)(n.statsPeriod):T(a)}),o=`equation|(percentile_range(transaction.duration,0.50,lessOrEquals,${s})-percentile_range(transaction.duration,0.50,greater,${s}))/percentile_range(transaction.duration,0.50,lessOrEquals,${s})`;let l=(0,w.ro)(n.sort,`-${k}`);const c=l.startsWith("-");y()(l,"-").startsWith("equation|(percentile_range(transaction.duration,0.50,lessOrEquals,")&&(l=c?`-${o}`:o);const p=["transaction","http.method","tpm()","p50()",o,"count_if(http.status_code,greaterOrEquals,500)",k,"total.transaction_duration","sum(transaction.duration)",`percentile_range(transaction.duration,0.50,lessOrEquals,${s})`,`percentile_range(transaction.duration,0.50,greater,${s})`],u={id:void 0,name:(0,d.t)("Performance"),query:"event.type:transaction has:http.method transaction.op:http.server",projects:[],fields:p,version:2},m=Array(u.fields.length).fill(v.z7);m[u.fields.length-1]="110",u.widths=m,n.statsPeriod||i||(u.range=T(a)),u.orderby=l;const h=(0,w.ro)(n.query,"");return u.query=`${u.query} ${function(t,e){const r=new b.MY(t);if(r.freeText.length>0){const t=r.freeText.join(" ");r.setFilterValues("transaction",[(0,x.D)(t)],!1),r.freeText=[]}return e&&(r.tokens=r.tokens.filter((t=>t.key&&q.includes(t.key)))),r.formatString()}(h,r)}`,Z.ZP.fromNewQueryWithLocation(u,t)}(r,E,{withStaticFilters:D},f);return(0,a.useEffect)((()=>{if(!S.current)return(0,s.QK)(g,f.slug,e),void(S.current=!0);i()(P,e.datetime)||(0,s.QK)(g,f.slug,e)}),[e.datetime,P,e,g,f,r,E]),(0,R.tZ)(l.Z,{title:(0,d.t)("Starfish"),orgSlug:f.slug,children:(0,R.tZ)(o.Z,{defaultSelection:{datetime:{start:null,end:null,utc:!1,period:T(f)}},children:(0,R.tZ)(Gt,{router:n,eventView:C,organization:f,location:r,projects:E,selection:e,withStaticFilters:D})})})}Kt.displayName="WebServiceView";const Ht=(0,g.Z)(Kt)}}]);
//# sourceMappingURL=../sourcemaps/app_views_starfish_views_webServiceView_index_tsx.bc9ff735eaa72c1ce796046ea8c6f70f.js.map