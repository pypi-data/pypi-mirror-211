(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_performanceDuration_tsx-app_views_performance_transactionSummary_transactionTa-95099b"],{"./app/components/performanceDuration.tsx":(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var a=n("./app/components/duration.tsx"),i=n("./app/utils.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function s(t){const e=function(t){return(0,i.ri)(t.nanoseconds)}(t)?t.nanoseconds/1e9:function(t){return(0,i.ri)(t.milliseconds)}(t)?t.milliseconds/1e3:t.seconds;return(0,r.tZ)(a.Z,{abbreviation:t.abbreviation,seconds:e,fixedDigits:2})}s.displayName="PerformanceDuration";const o=s},"./app/views/performance/transactionSummary/transactionTags/utils.tsx":(t,e,n)=>{"use strict";n.d(e,{Zn:()=>r,bZ:()=>s,oT:()=>l,oc:()=>d,vG:()=>o});var a=n("./app/utils/analytics.tsx"),i=n("./app/utils/queryString.tsx");function r(t){return(0,i.ro)(t.query.tagKey)}function s(t){(0,a.Gi)("performance_views.tags.interaction",{organization:t})}function o(t){let{orgSlug:e,transaction:n,projectID:a,query:i}=t;const r=function(t){let{orgSlug:e}=t;return`/organizations/${e}/performance/summary/tags/`}({orgSlug:e});return{pathname:r,query:{transaction:n,project:a,environment:i.environment,statsPeriod:i.statsPeriod,start:i.start,end:i.end,query:i.query,tagKey:i.tagKey}}}function d(t){let e=(0,i.ro)(t.query?.tagSort)??"-frequency";return["sumdelta"].find((t=>e?.includes(t)))&&(e="-frequency"),e}function l(t){const e=Object.keys(t).find((t=>t.includes("histogram")));if(!e)return;const n=e.split("_");return{histogramField:e,bucketSize:parseInt(n[n.length-3],10),offset:parseInt(n[n.length-2],10),multiplier:parseInt(n[n.length-1],10)}}},"./app/views/starfish/components/samplesTable/common.tsx":(t,e,n)=>{"use strict";n.d(e,{fd:()=>s});var a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=n("./app/locale.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function s(t){let{duration:e,p50:n}=t;const a=e-n;if(Math.floor(e)===Math.floor(n))return(0,r.tZ)(o,{children:(0,i.t)("At baseline")});const s=a>0?`+${a.toFixed(2)}ms above`:`${a.toFixed(2)}ms below`;return(0,r.tZ)(d,{value:a,children:s})}s.displayName="DurationComparisonCell";const o=(0,a.Z)("div",{target:"e1tr2orr1"})({name:"2qga7i",styles:"text-align:right"}),d=(0,a.Z)("div",{target:"e1tr2orr0"})("text-align:right;color:",(t=>t.value<0?t.theme.green400:t.theme.red400),";")},"./app/views/starfish/components/textAlign.tsx":(t,e,n)=>{"use strict";n.d(e,{Dq:()=>i,_F:()=>s,xe:()=>r});var a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js");const i=(0,a.Z)("span",{target:"e16p96xr2"})({name:"evqzij",styles:"text-align:right;width:100%"}),r=(0,a.Z)("span",{target:"e16p96xr1"})({name:"zq26zb",styles:"text-align:left;width:100%"}),s=(0,a.Z)("span",{target:"e16p96xr0"})({name:"12wal98",styles:"text-overflow:ellipsis;overflow:hidden;white-space:nowrap"})},"./app/views/starfish/views/webServiceView/endpointOverview/index.tsx":(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>J});var a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(n("../node_modules/core-js/modules/es.array.push.js"),n("../node_modules/react/index.js")),r=n("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),s=n("./app/components/charts/eventsRequest.tsx"),o=n("./app/components/datePageFilter.tsx"),d=n("./app/components/layouts/thirds.tsx"),l=n("./app/components/organizations/pageFilterBar.tsx"),c=n("./app/components/organizations/pageFilters/container.tsx"),p=n("./app/components/performance/layouts/index.tsx"),u=n("./app/components/segmentedControl.tsx"),m=n("./app/constants/chartPalette.tsx"),h=n("./app/locale.tsx"),g=n("./app/styles/space.tsx"),f=n("./app/utils/discover/eventView.tsx"),y=n("./app/utils/queryClient.tsx"),v=n("./app/utils/tokenizeSearch.tsx"),w=n("./app/utils/useLocation.tsx"),x=n("./app/utils/useOrganization.tsx"),Z=n("./app/utils/usePageFilters.tsx"),b=n("./app/utils/withApi.tsx"),k=n("./app/views/starfish/components/chart.tsx"),_=n("../node_modules/query-string/index.js"),j=n("./app/components/gridEditable/index.tsx"),q=n("./app/components/links/link.tsx"),S=n("./app/utils/discover/genericDiscoverQuery.tsx"),C=n("./app/views/performance/transactionSummary/transactionOverview/tagExplorer.tsx"),D=n("./app/views/starfish/components/sparkline.tsx"),T=n("./app/views/starfish/components/textAlign.tsx"),P=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const L=[{key:"tagKey",name:"Key",width:300},{key:"tagValue",name:"Value",width:200},{key:"p50",name:"p50(duration)",width:200},{key:"throughput",name:"tpm",width:200},{key:"tpmCorrelation",name:"tpm correlation",width:200}];function $(t,e){return{seriesName:t,data:e.map((t=>({name:t[0],value:t[1][0].count})))}}function F(t){let{eventView:e}=t;const n=(0,w.T)(),a=(0,x.Z)(),r=e.clone();r.fields=C.KZ;const s=r.withSorts([{field:"sumdelta",kind:"desc"}]),{isLoading:o,data:d}=(0,S.JC)({route:"events-facets-stats",eventView:e,location:n,orgSlug:a.slug,getRequestPayload:()=>({...s.getEventsAPIPayload(n),aggregateColumn:"transaction.duration"})});if(o)return null;const l=[],c=d?.totals,p=Object.keys(c);let u=!1;for(let t=0;t<p.length;t++){const e=p[t],n=(g=c[e].sum_correlation)>=.8?"very highly correlated":g>=.6?"highly correlated":g>=.4?"correlated":A;n!==A&&(u=!0,l.push({tagKey:e.split(",")[0],tagValue:e.split(",")[1],throughput:$("throughput",d[e]["count()"].data),p50:$("p50",d[e]["p75(transaction.duration)"].data),tpmCorrelation:n}))}var g;return!1===u?null:(0,P.BX)(i.Fragment,{children:[(0,P.tZ)(B,{children:(0,h.t)("Correlations")}),(0,P.tZ)(j.ZP,{isLoading:o,data:l,columnOrder:L,columnSortBy:[],location:n,grid:{renderBodyCell:(t,n)=>function(t,n){if("throughput"===t.key||"p50"===t.key)return(0,P.tZ)(D.ZP,{color:"throughput"===t.key?m.$[3][0]:m.$[3][1],series:n[t.key],width:t.width?t.width-t.width/5:void 0});if("tagValue"===t.key){const a=new v.MY(e.query);let i="";return a.tokens.forEach((t=>{t.key&&(i=i.concat(" ",`${t.key}:${t.value}`))})),i=i.concat(" ",`${n.tagKey}:${n.tagValue}`),(0,P.tZ)(T._F,{children:(0,P.tZ)(q.Z,{to:`/discover/homepage/?${_.stringify({...e.generateQueryStringObject(),query:i,field:["title","p50(transaction.duration)","p75(transaction.duration)","p95(transaction.duration)"],yAxis:"count()"})}`,children:n[t.key]})})}return(0,P.tZ)(T.xe,{children:n[t.key]})}(t,n)}})]})}F.displayName="FacetInsights";const A="no/low correlation";const B=(0,a.Z)("h3",{target:"e1oaag7v0"})("color:",(t=>t.theme.gray300),";font-size:",(t=>t.theme.fontSizeLarge),";margin:0;margin-bottom:",(0,g.D)(1),";");var z=n("./app/views/starfish/components/miniChartPanel.tsx"),V=n("./app/components/dateTime.tsx"),E=n("./app/components/duration.tsx"),O=n("./app/views/starfish/components/samplesTable/common.tsx"),I=n("./app/utils/discover/discoverQuery.tsx");const M=5,X=[{key:"id",name:"Event ID",width:200},{key:"profile_id",name:"Profile ID",width:200},{key:"timestamp",name:"Timestamp",width:300},{key:"transaction.duration",name:"Duration",width:200},{key:"p50_comparison",name:"Compared to P50",width:200}];function K(t){let{eventView:e}=t;const n=(0,w.T)(),{isLoading:a,data:i,aggregatesData:r}=function(t){const e=(0,w.T)(),n=(0,x.Z)(),a=[{field:"transaction.duration",kind:"field"},{field:"profile_id",kind:"field"},{field:"timestamp",kind:"field"}],i=t.clone().withColumns([{kind:"function",function:["p50","transaction.duration",void 0,void 0]},{kind:"function",function:["p95","transaction.duration",void 0,void 0]}]),{isLoading:r,data:s}=(0,I._)({eventView:i,referrer:"starfish-transaction-summary-sample-events",location:e,orgSlug:n.slug}),o=t.clone().withColumns(a).withSorts([{field:"transaction.duration",kind:"desc"}]);o.additionalConditions=new v.MY(`transaction.duration:>${s?.data?.[0]?.["p95(transaction.duration)"]??0}`);const{isLoading:d,data:l}=(0,I._)({eventView:o,referrer:"starfish-transaction-summary-sample-events",location:e,orgSlug:n.slug,limit:M}),c=t.clone().withColumns(a).withSorts([{field:"transaction.duration",kind:"desc"}]);c.additionalConditions=new v.MY(`transaction.duration:<=${s?.data?.[0]?.["p50(transaction.duration)"]??0}`);const{isLoading:p,data:u}=(0,I._)({eventView:c,referrer:"starfish-transaction-summary-sample-events",location:e,orgSlug:n.slug,limit:M}),m=t.clone().withColumns(a).withSorts([{field:"transaction.duration",kind:"asc"}]);m.additionalConditions=new v.MY(`transaction.duration:<=${s?.data?.[0]?.["p50(transaction.duration)"]??0}`);const{isLoading:h,data:g}=(0,I._)({eventView:m,referrer:"starfish-transaction-summary-sample-events",location:e,orgSlug:n.slug,limit:M});return r||d||p||h?{isLoading:!0,data:[]}:{isLoading:!1,data:[...l?.data??[],...u?.data??[],...g?.data??[]],aggregatesData:s?.data[0]??[]}}(e);return(0,P.tZ)(j.ZP,{isLoading:a,data:i,columnOrder:X,columnSortBy:[],location:n,grid:{renderHeadCell:function(t){return"p50_comparison"===t.key?(0,P.tZ)(T.Dq,{children:(0,P.tZ)(T._F,{children:t.name})}):(0,P.tZ)(T._F,{children:t.name})},renderBodyCell:function(t,e){return"id"===t.key?(0,P.tZ)(q.Z,{to:`/performance/${e["project.name"]}:${e.id}`,children:e.id.slice(0,8)}):"profile_id"===t.key?e.profile_id?(0,P.tZ)(q.Z,{to:`/profiling/profile/${e["project.name"]}/${e.profile_id}/flamechart/`,children:e.profile_id.slice(0,8)}):"(no value)":"transaction.duration"===t.key?(0,P.tZ)(E.Z,{seconds:e["transaction.duration"]/1e3,fixedDigits:2,abbreviation:!0}):"timestamp"===t.key?(0,P.tZ)(V.Z,{date:e[t.key],year:!0,timeZone:!0,seconds:!0}):"p50_comparison"===t.key?(0,P.tZ)(O.fd,{duration:e["transaction.duration"],p50:r?.["p50(transaction.duration)"]??0}):(0,P.tZ)(T.xe,{children:e[t.key]})}}})}K.displayName="TransactionSamplesTable";var N=n("./app/views/starfish/types.tsx"),R=n("./app/views/starfish/utils/constants.tsx"),Y=n("./app/views/starfish/views/spans/queries.tsx"),Q=n("./app/views/starfish/views/spans/spansTable.tsx"),W=n("./app/views/starfish/views/spans/spansView.tsx"),G=n("./app/views/starfish/views/webServiceView/spanGroupBreakdownContainer.tsx");const U=5,H=(0,b.Z)(s.Z);function J(){const t=(0,w.T)(),e=(0,x.Z)(),n=(0,r.u)(),{endpoint:a,method:s,statsPeriod:p}=t.query,g=a?Array.isArray(a)?a[0]:a:void 0,y=(0,Z.Z)(),[b,_]=(0,i.useState)({spansFilter:N.r.ALL}),j=["has:http.method","transaction.op:http.server",`transaction:${g}`,`http.method:${s}`],q=new v.MY(j),S={id:void 0,name:(0,h.t)("Endpoint Overview"),query:q.formatString(),projects:[1],fields:[],version:2},C=f.ZP.fromNewQueryWithLocation(S,t);return(0,P.tZ)(c.Z,{children:(0,P.BX)(d.T3,{children:[(0,P.tZ)(d.h4,{children:(0,P.tZ)(d.oB,{children:(0,P.tZ)(d.Dx,{children:(0,h.t)("Endpoint Overview")})})}),(0,P.BX)(d.uT,{children:[(0,P.tZ)(nt,{children:(0,P.tZ)(l.Z,{condensed:!0,children:(0,P.tZ)(o.Z,{alignDropdown:"left"})})}),(0,P.BX)(d.or,{fullWidth:!0,children:[(0,P.tZ)(et,{children:(0,h.t)("Endpoint URL")}),(0,P.tZ)("pre",{children:`${s} ${g}`}),(0,P.tZ)(at,{minSize:200,children:(0,P.BX)(it,{children:[(0,P.tZ)(rt,{children:(0,P.tZ)(G._,{transaction:g})}),(0,P.BX)(st,{children:[(0,P.tZ)(z.Z,{title:(0,h.t)("Error Rate"),children:(0,P.tZ)(H,{query:q.formatString(),includePrevious:!1,partial:!0,interval:"1h",includeTransformedData:!0,limit:1,environment:C.environment,project:C.project,period:C.statsPeriod,referrer:"starfish-homepage-failure-rate",start:C.start,end:C.end,organization:e,yAxis:"equation|count_if(http.status_code,greaterOrEquals,500)/(count_if(http.status_code,equals,200)+count_if(http.status_code,greaterOrEquals,500))",children:t=>{const e=t.timeseriesData?.map((t=>({data:t.data,seriesName:(0,h.t)("Error Rate"),color:m.$[5][3],silent:!0})));return e?(0,P.tZ)(i.Fragment,{children:(0,P.tZ)(k.Z,{statsPeriod:C.statsPeriod,height:80,data:e,start:C.start,end:C.end,loading:t.loading,utc:!1,grid:{left:"0",right:"0",top:"8px",bottom:"0"},definedAxisTicks:2,isLineChart:!0,chartColors:n.charts.getColorPalette(2),disableXAxis:!0,aggregateOutputFormat:"percentage"})}):null}})}),(0,P.tZ)(H,{query:q.formatString(),includePrevious:!1,partial:!0,limit:5,interval:"1h",includeTransformedData:!0,environment:C.environment,project:C.project,period:y.selection.datetime.period,referrer:"starfish-endpoint-overview",start:y.selection.datetime.start,end:y.selection.datetime.end,organization:e,yAxis:["tpm()","p95(transaction.duration)","p50(transaction.duration)"],queryExtras:{dataset:"metrics"},children:t=>{let{results:e,loading:a}=t;return(0,P.BX)(i.Fragment,{children:[(0,P.tZ)(z.Z,{title:(0,h.t)("Duration"),children:(0,P.tZ)(k.Z,{statsPeriod:p??"24h",height:110,data:e?.[1]?[e?.[1],e?.[2]]:[],start:"",end:"",loading:a,utc:!1,isLineChart:!0,disableXAxis:!0,definedAxisTicks:2,chartColors:n.charts.getColorPalette(2),grid:{left:"0",right:"0",top:"8px",bottom:"16px"}})}),(0,P.tZ)(z.Z,{title:(0,h.t)("Throughput"),children:(0,P.tZ)(k.Z,{statsPeriod:p??"24h",height:80,data:e?.[0]?[e?.[0]]:[],start:"",end:"",loading:a,utc:!1,stacked:!0,isLineChart:!0,disableXAxis:!0,definedAxisTicks:2,chartColors:[n.charts.getColorPalette(0)[0]],grid:{left:"0",right:"0",top:"8px",bottom:"16px"}})})]})}})]})]})}),(0,P.tZ)(et,{children:(0,h.t)("Sample Events")}),(0,P.tZ)(K,{eventView:C}),(0,P.tZ)(ot,{children:(0,P.BX)(u.s,{size:"xs","aria-label":(0,h.t)("Filter Spans"),value:b.spansFilter,onChange:t=>_({...b,spansFilter:t}),children:[(0,P.tZ)(u.s.Item,{children:(0,h.t)("All Spans")},""),(0,P.tZ)(u.s.Item,{children:(0,h.t)("http")},"http"),(0,P.tZ)(u.s.Item,{children:(0,h.t)("db")},"db")]})}),(0,P.tZ)(tt,{filter:b.spansFilter,transaction:g}),(0,P.tZ)(F,{eventView:C})]})]})]})})}function tt(t){let{filter:e,transaction:n}=t;const a=(0,w.T)(),i=(0,Z.Z)(),r=(0,W.T)(e||N.r.ALL,a);n&&r.push(`transaction = '${n}'`);const s=(0,Y.FU)(i.selection.datetime,r,"count",U),{isLoading:o,data:d}=(0,y.aM)({queryKey:["spans",s],queryFn:()=>fetch(`${R.M}/?query=${s}&format=sql`).then((t=>t.json())),retry:!1,refetchOnWindowFocus:!1,initialData:[]}),l=d.map((t=>{let{group_id:e}=t;return e})),{isLoading:c,data:p}=(0,y.aM)({queryKey:["spansTrends"],queryFn:()=>fetch(`${R.M}/?query=${(0,Y.Au)(i.selection.datetime,l)}`).then((t=>t.json())),retry:!1,refetchOnWindowFocus:!1,initialData:[],enabled:l.length>0});return(0,P.tZ)(Q.ZP,{moduleName:N.r.ALL,isLoading:o||c,spansData:d,orderBy:"count",onSetOrderBy:()=>{},spansTrendsData:p})}J.displayName="EndpointOverview",tt.displayName="SpanMetricsTable";const et=(0,a.Z)("h3",{target:"e1mmy0la6"})("color:",(t=>t.theme.gray300),";font-size:",(t=>t.theme.fontSizeLarge),";margin:0;margin-bottom:",(0,g.D)(1),";"),nt=(0,a.Z)("div",{target:"e1mmy0la5"})("display:grid;grid-template-rows:auto auto auto;gap:",(0,g.D)(2),";margin-bottom:",(0,g.D)(2),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){grid-template-rows:auto;grid-template-columns:auto 1fr auto;}"),at=(0,a.Z)(p.c,{target:"e1mmy0la4"})("margin-bottom:",(0,g.D)(2),";"),it=(0,a.Z)("div",{target:"e1mmy0la3"})("display:flex;flex-direction:row;flex-wrap:wrap;gap:",(0,g.D)(2),";"),rt=(0,a.Z)("div",{target:"e1mmy0la2"})({name:"1xy7mri",styles:"flex:1.5"}),st=(0,a.Z)("div",{target:"e1mmy0la1"})({name:"82a6rk",styles:"flex:1"}),ot=(0,a.Z)("div",{target:"e1mmy0la0"})("margin-bottom:",(0,g.D)(2),";")},"../node_modules/lodash/negate.js":t=>{t.exports=function(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}},"../node_modules/lodash/omitBy.js":(t,e,n)=>{var a=n("../node_modules/lodash/_baseIteratee.js"),i=n("../node_modules/lodash/negate.js"),r=n("../node_modules/lodash/pickBy.js");t.exports=function(t,e){return r(t,i(a(e)))}}}]);
//# sourceMappingURL=../sourcemaps/app_components_performanceDuration_tsx-app_views_performance_transactionSummary_transactionTa-95099b.3a1c300ed4f7c0337e5ef15f34863936.js.map