"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionAnomalies_index_tsx"],{"./app/components/charts/chartZoom.tsx":(e,t,n)=>{n.d(t,{Z:()=>f});var a=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(n("../node_modules/core-js/modules/es.array.push.js"),n("../node_modules/react/index.js")),s=n("../node_modules/moment/moment.js"),i=n.n(s),r=n("../node_modules/query-string/index.js"),d=n("./app/actionCreators/pageFilters.tsx"),l=n("./app/components/charts/components/dataZoomInside.tsx");n("../node_modules/echarts/lib/component/dataZoomSlider.js");const c={realtime:!1,showDetail:!1,left:0,right:6,bottom:8};function p(e){return e&&Array.isArray(e)?e:[{...c,...e}]}var m=n("./app/components/charts/components/toolBox.tsx"),u=n("./app/utils/callIfFunction.tsx"),h=n("./app/utils/dates.tsx");const g=e=>e?i().utc(e).format(i().HTML5_FMT.DATETIME_LOCAL_SECONDS):null;class y extends o.Component{constructor(e){var t;super(e),t=this,(0,a.Z)(this,"history",void 0),(0,a.Z)(this,"currentPeriod",void 0),(0,a.Z)(this,"zooming",null),(0,a.Z)(this,"saveCurrentPeriod",(e=>{this.currentPeriod={period:e.period,start:g(e.start),end:g(e.end)}})),(0,a.Z)(this,"setPeriod",(function(e){let{period:n,start:a,end:o}=e,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{router:i,onZoom:l,usePageDate:c}=t.props,p=g(a),m=g(o);s&&t.history.push(t.currentPeriod),l?.({period:n,start:p,end:m}),t.zooming=()=>{if(c&&i){const e={...i.location.query,pageStart:a?(0,h.v5)(a):void 0,pageEnd:o?(0,h.v5)(o):void 0,pageStatsPeriod:n??void 0};r.stringify(e)!==r.stringify(i.location.query)&&i.push({pathname:i.location.pathname,query:e})}else(0,d.dR)({period:n,start:p?(0,h.hC)(p):p,end:m?(0,h.hC)(m):m},i,{skipDesyncUpdate:!0});t.saveCurrentPeriod({period:n,start:a,end:o})}})),(0,a.Z)(this,"handleChartReady",(e=>{this.props.onChartReady?.(e)})),(0,a.Z)(this,"handleZoomRestore",((e,t)=>{this.history.length&&(this.setPeriod(this.history[0]),this.history=[],this.props.onRestore?.(e,t))})),(0,a.Z)(this,"handleDataZoom",((e,t)=>{const n=t.getModel(),{startValue:a,endValue:o}=n._payload.batch[0];if(null===a&&null===o){const e=this.history.pop();if(!e)return;this.setPeriod(e)}else{const e=i().utc(a),t=i().utc(o);this.setPeriod({period:null,start:e,end:t},!0)}this.props.onDataZoom?.(e,t)})),(0,a.Z)(this,"handleChartFinished",((e,t)=>{"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const n=t._componentsViews?.find((e=>e._features&&e._features.dataZoom));n&&!n._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0}),(0,u.g)(this.props.onFinished)})),this.history=[],this.saveCurrentPeriod(e)}componentDidUpdate(){this.props.disabled||this.saveCurrentPeriod(this.props)}render(){const{utc:e,start:t,end:n,disabled:a,children:o,xAxisIndex:s,router:i,onZoom:r,onRestore:d,onChartReady:c,onDataZoom:u,onFinished:g,showSlider:y,chartZoomOptions:f,...x}=this.props,Z=e??void 0,v=t?(0,h.hC)(t):void 0,w=n?(0,h.hC)(n):void 0;return o(a?{utc:Z,start:v,end:w,...x}:{isGroupedByDate:!0,onChartReady:this.handleChartReady,utc:Z,start:v,end:w,dataZoom:y?[...p({xAxisIndex:s,...f}),...(0,l.Z)({xAxisIndex:s,...f})]:(0,l.Z)({xAxisIndex:s,...f}),showTimeInTooltip:!0,toolBox:(0,m.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom,onFinished:this.handleChartFinished,onRestore:this.handleZoomRestore,...x})}}y.displayName="ChartZoom";const f=y},"./app/components/charts/components/dataZoomInside.tsx":(e,t,n)=>{n.d(t,{Z:()=>o}),n("../node_modules/echarts/lib/component/dataZoomInside.js");const a={type:"inside",zoomOnMouseWheel:!1,zoomLock:!0,throttle:50};function o(e){return e&&Array.isArray(e)?e:[{...a,...e}]}},"./app/components/charts/components/markArea.tsx":(e,t,n)=>{function a(e){return{...e}}n.d(t,{Z:()=>a}),n("../node_modules/echarts/lib/component/markArea.js")},"./app/components/charts/components/toolBox.tsx":(e,t,n)=>{function a(){let{dataZoom:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e?{dataZoom:{yAxisIndex:"none",title:{zoom:"zoom",back:"undo"},...e}}:{},...t}}function o(e,t){return{right:0,top:0,itemSize:16,z:-1,feature:a(t),...e}}n.d(t,{Z:()=>o})},"./app/components/charts/errorPanel.tsx":(e,t,n)=>{n.d(t,{Z:()=>a});const a=(0,n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1t1x7f30"})("display:flex;flex-direction:column;justify-content:center;align-items:center;flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height||"200px"),";position:relative;border-color:transparent;margin-bottom:0;color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeExtraLarge),";")},"./app/components/charts/lineChart.tsx":(e,t,n)=>{n.d(t,{w:()=>i});var a=n("./app/components/charts/series/lineSeries.tsx"),o=n("./app/components/charts/baseChart.tsx"),s=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{series:t,seriesOptions:n,...i}=e;return(0,s.tZ)(o.Z,{...i,series:t.map((e=>{let{seriesName:t,data:o,dataArray:s,...i}=e;return(0,a.Z)({...n,...i,name:t,data:s||o?.map((e=>{let{value:t,name:n}=e;return[n,t]})),animation:!1,animationThreshold:1,animationDuration:0})}))})}i.displayName="LineChart"},"./app/components/events/searchBar.tsx":(e,t,n)=>{n.d(t,{Z:()=>z}),n("../node_modules/core-js/modules/es.error.cause.js");var a=n("../node_modules/react/index.js"),o=n("../node_modules/lodash/assign.js"),s=n.n(o),i=n("../node_modules/lodash/flatten.js"),r=n.n(i),d=n("../node_modules/lodash/memoize.js"),l=n.n(d),c=n("../node_modules/lodash/omit.js"),p=n.n(c),m=n("./app/actionCreators/tags.tsx"),u=n("./app/components/smartSearchBar/index.tsx"),h=n("./app/constants/index.tsx"),g=n("./app/types/index.tsx"),y=n("./app/utils.tsx"),f=n("./app/utils/discover/fields.tsx"),x=n("./app/utils/fields/index.ts"),Z=n("./app/utils/measurements/measurements.tsx"),v=n("./app/utils/useApi.tsx"),w=n("./app/utils/withTags.tsx"),b=n("./app/views/dashboards/utils.tsx"),j=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const C=new RegExp(`^${h.c$}|\\${h.ir}`,"g"),D=new Set(Object.keys(f.wZ)),S=Object.keys(f.wZ).reduce(((e,t)=>(e[t]={...f.wZ[t],kind:x.IV.FIELD},e)),{}),k=p()(S,f.J8),P=f.$4.reduce(((e,t)=>(e[t]={name:t,kind:x.IV.METRICS},e)),{}),_=Object.keys(f.jg).reduce(((e,t)=>(e[t]={...f.jg[t],kind:x.IV.FIELD},e)),{});function A(e){const{maxSearchItems:t,organization:n,tags:o,omitTags:i,fields:d,projectIds:c,includeSessionTagsValues:h,maxMenuHeight:w,customMeasurements:A}=e,z=(0,v.Z)(),T=(0,a.useMemo)((()=>(e=>e?.length?e.reduce(((e,t)=>(D.has(t.field)||(0,f.GO)(t.field)||(0,b.nk)(t.field)||(e[t.field]={key:t.field,name:t.field,kind:x.IV.FUNCTION}),e)),{}):[])(d)),[d]),E=(0,a.useMemo)((()=>Object.keys(o).reduce(((e,t)=>(e[t]={...o[t],kind:x.IV.TAG},e)),{})),[o]);(0,a.useEffect)((()=>{L.cache.clear?.()}),[c]);const L=l()(((e,t,a)=>{const o=c?.map(String);return(0,f.h1)(e.key)||(0,f.Xr)(e.key)?Promise.resolve([]):(0,x.bn)(e.key)?Promise.resolve(x.BF):(0,m.Fo)({api:z,orgSlug:n.slug,tagKey:e.key,search:t,projectIds:o,endpointParams:a,includeTransactions:!0,includeSessions:h}).then((e=>r()(e.filter((e=>{let{name:t}=e;return(0,y.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:n}=e;return`${n}-${t}`})),q=e=>{const t=((e,t)=>{const n=Object.keys(e).reduce(((t,n)=>(t[n]={...e[n],kind:x.IV.MEASUREMENT},t)),{});return t?Object.keys(t).reduce(((e,n)=>(e[n]={...t[n],kind:x.IV.MEASUREMENT},e)),n):n})(e,A),a=n.features.includes("performance-view")?Object.assign({},t,T,P,S):Object.assign({},k);return s()(a,E,S,_),a.has={key:x.Sh.HAS,name:"Has property",values:Object.keys(a).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),predefined:!0,kind:x.IV.FIELD},i&&i.length>0?p()(a,i):a};return(0,j.tZ)(Z.Z,{children:n=>{let{measurements:a}=n;return(0,j.tZ)(u.Z,{hasRecentSearches:!0,savedSearchType:g.L4.EVENT,onGetTagValues:L,supportedTags:q(a),prepareQuery:e=>e.replace(C,""),maxSearchItems:t,excludedTags:[x.Sh.ENVIRONMENT,x.Sh.TOTAL_COUNT],maxMenuHeight:w??300,customPerformanceMetrics:A,...e})}})}A.displayName="SearchBar";const z=(0,w.Z)(A)},"./app/components/gridEditable/sortLink.tsx":(e,t,n)=>{n.d(t,{Z:()=>m});var a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=n("../node_modules/react-router/es/index.js"),s=n("./app/components/links/link.tsx"),i=n("./app/icons/index.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{align:t,title:n,canSort:a,generateSortLink:s,onClick:i,direction:d,replace:m}=e;const u=s();if(!u||!a)return(0,r.tZ)(c,{align:t,children:n});const h=d?(0,r.tZ)(p,{size:"xs",direction:"desc"===d?"down":"up"}):null;return(0,r.BX)(l,{align:t,to:u,onClick:e=>{m&&(e.preventDefault(),o.browserHistory.replace(u)),i?.(e)},children:[n," ",h]})}d.displayName="SortLink";const l=(0,a.Z)((e=>{const{align:t,css:n,...a}=e;return(0,r.tZ)(s.Z,{...a})}),{target:"esdhr0u2"})("display:block;width:100%;white-space:nowrap;color:inherit;&:hover,&:active,&:focus,&:visited{color:inherit;}",(e=>e.align?`text-align: ${e.align};`:""),";"),c=(0,a.Z)("div",{target:"esdhr0u1"})("display:block;width:100%;white-space:nowrap;",(e=>e.align?`text-align: ${e.align};`:""),";"),p=(0,a.Z)(i.CC,{target:"esdhr0u0"})({name:"40f4ru",styles:"vertical-align:top"}),m=d},"./app/utils/performance/anomalies/anomaliesQuery.tsx":(e,t,n)=>{n.d(t,{Z:()=>l});var a=n("./app/utils/discover/genericDiscoverQuery.tsx"),o=n("./app/views/performance/transactionSummary/transactionAnomalies/utils.tsx"),s=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){return e.data.forEach((e=>e[0]=1e3*e[0])),e}function r(e){const t={...e};return e.y&&e.yhat_lower&&e.yhat_upper&&e.anomalies?(t.y=i(e.y),t.yhat_upper=i(e.yhat_upper),t.yhat_lower=i(e.yhat_lower),t.anomalies=((n=e.anomalies).forEach((e=>{e.start=1e3*e.start,e.end=1e3*e.end})),n),t):t;var n}function d(e){return e.organization.features.includes(o.uT)?(0,s.tZ)(a.ZP,{route:"transaction-anomaly-detection",...e,children:t=>{let{tableData:n,...a}=t;return e.children({data:n&&n.y?r(n):null,...a})}}):(0,s.tZ)("div",{children:e.children({data:null,isLoading:!1,error:null,pageLinks:null})})}d.displayName="AnomaliesSeriesQuery";const l=d},"./app/utils/withTags.tsx":(e,t,n)=>{n.d(t,{Z:()=>d});var a=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=n("../node_modules/react/index.js"),s=n("./app/stores/tagStore.tsx"),i=n("./app/utils/getDisplayName.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const d=function(e){class t extends o.Component{constructor(){super(...arguments),(0,a.Z)(this,"state",{tags:s.Z.getState()}),(0,a.Z)(this,"unsubscribe",s.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...n}=this.props;return(0,r.tZ)(e,{tags:t??this.state.tags,...n})}}return t.displayName="WithTags",(0,a.Z)(t,"displayName",`withTags(${(0,i.Z)(e)})`),t}},"./app/views/performance/landing/widgets/components/performanceWidget.tsx":(e,t,n)=>{n.d(t,{I:()=>z});var a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=n("../node_modules/react/index.js"),s=n("./app/components/charts/errorPanel.tsx"),i=n("./app/components/placeholder.tsx"),r=n("./app/icons/iconWarning.tsx"),d=n("./app/styles/space.tsx"),l=n("./app/utils/analytics.tsx"),c=n("./app/utils/getDynamicText.tsx"),p=n("./app/utils/performance/contexts/metricsEnhancedPerformanceDataContext.tsx"),m=n("./app/utils/useApi.tsx"),u=n("./app/components/panels/index.tsx");const h=(0,a.Z)(u.s_,{target:"ekfeesi1"})("padding-top:",(0,d.D)(2),";margin-bottom:0;"),g=(0,a.Z)("div",{target:"ekfeesi0"})(""),y=e=>{let{containerType:t}=e;return"panel"===t?h:g};var f=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function x(e){return e.isErrored?e.errorComponent:e.isLoading&&e.loadingComponent?e.loadingComponent:e.hasData?(0,f.tZ)(o.Fragment,{children:e.dataComponents}):e.emptyComponent}x.displayName="DataStateSwitch";var Z=n("./app/utils/dates.tsx");function v(e){const t=e.children??(0,f.tZ)(o.Fragment,{});return e.queries.length?(0,f.tZ)(o.Fragment,{children:e.queries.filter((t=>!t.enabled||t.enabled(e.widgetData))).map((t=>(0,f.tZ)(w,{...e,query:t},t.queryKey)))}):(0,f.tZ)(o.Fragment,{children:t})}function w(e){const t=e.query,n=e.queryProps.eventView.getPageFilters(),a=n.datetime.start?(0,Z.hC)(n.datetime.start):null,s=n.datetime.end?(0,Z.hC)(n.datetime.end):null;return(0,o.useEffect)((()=>()=>{e.removeWidgetDataForKey(t.queryKey)}),[]),(0,f.tZ)(t.component,{fields:t.fields,yAxis:t.fields,start:a,end:s,period:n.datetime.period,project:n.projects,environment:n.environments,organization:e.queryProps.organization,orgSlug:e.queryProps.organization.slug,eventView:e.queryProps.eventView,query:e.queryProps.eventView.getQueryWithAdditionalConditions(),widgetData:e.widgetData,referrer:(i=e.queryProps.chartSetting,`api.performance.generic-widget-chart.${i.replace(/_/g,"-")}`),children:n=>(0,f.tZ)(o.Fragment,{children:(0,f.tZ)(b,{results:n,...e,query:t})})},t.queryKey);var i}function b(e){const t=(0,p.EA)(),{results:n,query:a}=e,s=a.transform(e.queryProps,n,e.query);return(0,o.useEffect)((()=>{const o=(0,p.AQ)(n,e.queryProps.fields[0]);t.setIsMetricsData(o),e.setWidgetDataForKey(a.queryKey,s)}),[s?.hasData,s?.isLoading,s?.isErrored]),(0,f.tZ)(o.Fragment,{})}v.displayName="QueryHandler",w.displayName="SingleQueryHandler",b.displayName="QueryResultSaver";var j=n("./app/components/charts/styles.tsx"),C=n("./app/components/questionTooltip.tsx"),D=n("./app/components/textOverflow.tsx");function S(e){const{title:t,titleTooltip:n,Subtitle:a,HeaderActions:o,InteractiveTitle:s}=e;return(0,f.BX)(_,{children:[(0,f.BX)(P,{children:[(0,f.BX)(k,{"data-test-id":"performance-widget-title",children:[s?(0,f.tZ)(s,{...e}):(0,f.tZ)(D.Z,{children:t}),(0,f.tZ)(p.hX,{}),n&&(0,f.tZ)(C.Z,{position:"top",size:"sm",title:n})]}),a?(0,f.tZ)(a,{...e}):null]}),(0,f.tZ)(A,{children:o&&(0,f.tZ)(o,{...e})})]})}S.displayName="WidgetHeader";const k=(0,a.Z)(j.ws,{target:"e1sjff3s3"})("position:relative;z-index:initial;top:-",(0,d.D)(.5),";"),P=(0,a.Z)("div",{target:"e1sjff3s2"})({name:"6kz1wu",styles:"display:flex;flex-direction:column;align-items:flex-start"}),_=(0,a.Z)("div",{target:"e1sjff3s1"})("display:flex;justify-content:space-between;align-items:flex-start;gap:",(0,d.D)(1),";"),A=(0,a.Z)("div",{target:"e1sjff3s0"})("display:flex;align-items:center;gap:",(0,d.D)(1),";");function z(e){const[t,n]=(0,o.useState)({}),a=t[e.chartSetting]??{},s=(0,o.useRef)(a),i=(0,o.useCallback)(((t,a)=>{const o={...s.current,[t]:a};s.current=o,n({[e.chartSetting]:o})}),[t,n]),r=(0,o.useCallback)((t=>{const a={...s.current};delete a[t],s.current=a,n({[e.chartSetting]:a})}),[t,n]),d={widgetData:a,setWidgetDataForKey:i,removeWidgetDataForKey:r},l=Object.entries(e.Queries).map((e=>{let[t,n]=e;return{...n,queryKey:t}})),c=(0,m.Z)(),u=e.Visualizations.reduce(((e,t)=>e+t.height),0);return(0,f.tZ)(o.Fragment,{children:(0,f.BX)(p.UT,{chartSetting:e.chartSetting,children:[(0,f.tZ)(v,{eventView:e.eventView,widgetData:a,setWidgetDataForKey:i,removeWidgetDataForKey:r,queryProps:e,queries:l,api:c}),(0,f.tZ)(T,{...e,...d,totalHeight:u})]})})}function T(e){const{Visualizations:t,chartHeight:n,totalHeight:a,containerType:o,EmptyComponent:s}=e,r=y({containerType:o}),d=Object.keys(e.Queries).length,p=Object.values(e.widgetData).length!==d,m=!p&&Object.values(e.widgetData).every((e=>!e||e.hasData)),u=Object.values(e.widgetData).some((e=>!e||e.isLoading)),h=!p&&Object.values(e.widgetData).some((e=>e&&e.isErrored));return(0,f.BX)(r,{"data-test-id":"performance-widget-container",children:[(0,f.tZ)(q,{children:(0,f.tZ)(S,{...e})}),(0,f.tZ)(x,{isLoading:u,isErrored:h,hasData:m,errorComponent:(0,f.tZ)(E,{height:a}),dataComponents:t.map(((t,a)=>(0,f.tZ)(q,{noPadding:t.noPadding,bottomPadding:t.bottomPadding,"data-test-id":"widget-state-has-data",onClick:()=>{return t=e.chartSetting,n=e.organization,void(0,l.Gi)("performance_views.landingv3.widget.interaction",{organization:n,widget_type:t});var t,n},children:(0,c.Z)({value:(0,f.tZ)(t.component,{grid:L,queryFields:t.fields,widgetData:e.widgetData,height:n}),fixed:(0,f.tZ)(i.Z,{height:`${n}px`})})},a))),loadingComponent:(0,f.tZ)(N,{height:`${a}px`}),emptyComponent:s?(0,f.tZ)(s,{}):(0,f.tZ)(N,{height:`${a}px`})})]})}function E(e){return(0,f.tZ)(s.Z,{"data-test-id":"widget-state-is-errored",height:`${e.height}px`,children:(0,f.tZ)(r.F,{color:"gray300",size:"lg"})})}z.displayName="GenericPerformanceWidget",T.displayName="DataDisplay",E.displayName="DefaultErrorComponent";const L={left:(0,d.D)(0),right:(0,d.D)(0),top:(0,d.D)(2),bottom:(0,d.D)(1)},q=(0,a.Z)("div",{target:"e1fmuurf1"})("padding-left:",(e=>e.noPadding?(0,d.D)(0):(0,d.D)(2)),";padding-right:",(e=>e.noPadding?(0,d.D)(0):(0,d.D)(2)),";padding-bottom:",(e=>e.bottomPadding?(0,d.D)(1):(0,d.D)(0)),";"),N=(0,a.Z)(i.Z,{target:"e1fmuurf0"})({name:"cs3onb",styles:"border-color:transparent;border-bottom-right-radius:inherit;border-bottom-left-radius:inherit"});z.defaultProps={containerType:"panel",chartHeight:200}},"./app/views/performance/transactionSummary/transactionAnomalies/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>pe});var a=n("./app/locale.tsx"),o=n("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),s=n("./app/utils/withOrganization.tsx"),i=n("./app/utils/withProjects.tsx"),r=n("./app/views/performance/transactionSummary/pageLayout.tsx"),d=n("./app/views/performance/transactionSummary/tabs.tsx"),l=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),c=(n("../node_modules/core-js/modules/es.array.push.js"),n("../node_modules/react/index.js")),p=n("../node_modules/react-router/es/index.js"),m=n("../node_modules/lodash/omit.js"),u=n.n(m),h=n("./app/components/charts/components/markArea.tsx"),g=n("./app/components/charts/components/markLine.tsx"),y=n("./app/components/datePageFilter.tsx"),f=n("./app/components/environmentPageFilter.tsx"),x=n("./app/components/events/searchBar.tsx"),Z=n("./app/components/layouts/thirds.tsx"),v=n("./app/components/organizations/pageFilterBar.tsx"),w=n("./app/components/organizations/pageFilters/parse.tsx"),b=n("./app/styles/space.tsx"),j=n("./app/utils.tsx"),C=n("./app/utils/performance/anomalies/anomaliesQuery.tsx"),D=n("./app/utils/queryString.tsx"),S=n("./app/utils/theme.tsx"),k=n("./app/views/performance/landing/widgets/components/performanceWidget.tsx"),P=n("./app/views/performance/landing/widgets/components/selectableList.tsx"),_=n("./app/views/performance/landing/widgets/widgetDefinitions.tsx"),A=n("./app/components/count.tsx"),z=n("./app/components/gridEditable/index.tsx"),T=n("./app/components/gridEditable/sortLink.tsx"),E=n("./app/icons/index.tsx"),L=n("./app/utils/discover/fieldRenderers.tsx"),q=n("./app/utils/discover/fields.tsx"),N=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const I=e=>({anomaly:`#${e.id}`,confidence:e.confidence,timestamp:new Date(e.start),timeInterval:e.end-e.start,expected:e.expected,received:e.received});function F(e){const{location:t,organization:n,isLoading:a,anomalies:o}=e,s=o?.map(I)||[];return(0,N.tZ)(z.ZP,{isLoading:a,data:s,columnOrder:Object.values(W),columnSortBy:[],grid:{renderHeadCell:O,renderBodyCell:V(t,n)},location:t})}function O(e,t){const n=(0,q.qG)(e.key,$[e.key]);return(0,N.tZ)(T.Z,{title:e.name,align:n,direction:void 0,canSort:!1,generateSortLink:()=>{}})}function V(e,t){return function(n,o){const s=(0,L.Js)(n.key,$);return"confidence"===n.key?(0,N.tZ)(M,{children:"low"===o.confidence?(0,N.tZ)(R,{children:(0,a.t)("Low Confidence")}):(0,N.tZ)(H,{children:(0,a.t)("High Confidence")})}):"expected"===n.key?(0,N.tZ)(B,{children:(0,N.tZ)(A.Z,{value:o.expected})}):"received"===n.key?(0,N.BX)(B,{children:[(0,N.tZ)(A.Z,{value:o.received}),(0,N.tZ)(E.CC,{size:"sm",direction:o.received>o.expected?"up":"down"})]}):s(o,{location:e,organization:t})}}F.displayName="AnomaliesTable",O.displayName="renderHeadCell";const B=(0,l.Z)("div",{target:"e1f42zpu3"})("display:flex;justify-content:flex-end;align-items:center;gap:",(0,b.D)(.5),";"),R=(0,l.Z)("div",{target:"e1f42zpu2"})("color:",(e=>e.theme.yellow400),";"),H=(0,l.Z)("div",{target:"e1f42zpu1"})("color:",(e=>e.theme.red400),";"),M=(0,l.Z)("div",{target:"e1f42zpu0"})({name:"1qetfgc",styles:"text-align:left;justify-self:flex-end;flex-grow:1"}),W={anomaly:{key:"anomaly",name:(0,a.t)("Anomaly"),width:z.z7},confidence:{key:"confidence",name:(0,a.t)("Confidence"),width:z.z7},timeInterval:{key:"timeInterval",name:(0,a.t)("Time Interval"),width:z.z7},timestamp:{key:"timestamp",name:(0,a.t)("Timestamp"),width:z.z7},expected:{key:"expected",name:(0,a.t)("Expected"),width:z.z7},received:{key:"received",name:(0,a.t)("Received"),width:z.z7}},$={anomaly:"string",confidence:"string",timeInterval:"duration",timestamp:"date",expected:"number",received:"number"};var K=n("./app/components/charts/chartZoom.tsx"),X=n("./app/components/charts/lineChart.tsx"),Q=n("./app/utils/dates.tsx"),U=n("./app/utils/discover/charts.tsx"),G=n("./app/utils/useLocation.tsx"),J=n("./app/utils/useRouter.tsx");function Y(e){const t=(0,J.Z)(),n=(0,G.T)(),{data:o,statsPeriod:s,height:i,start:r,end:d}=e,l=r?(0,Q.hC)(r):null,c=d?(0,Q.hC)(d):null,{utc:p}=(0,w.fK)(n.query),m={legend:{right:10,top:5,data:[(0,a.t)("High Confidence"),(0,a.t)("Low Confidence")]},seriesOptions:{showSymbol:!1},height:i,tooltip:{trigger:"axis",valueFormatter:(e,t)=>(0,U.CX)(e,(0,q.Px)(t))},xAxis:void 0,yAxis:{axisLabel:{formatter:e=>(0,U.gu)(e,"number")}}};return(0,N.tZ)(K.Z,{router:t,period:s,start:l,end:c,utc:"true"===p,children:e=>(0,N.tZ)(X.w,{...e,series:o,...m})})}Y.displayName="AnomalyChart";const ee=e=>`#${e.id}`,te=e=>[{name:ee(e),xAxis:e.start},{xAxis:e.end}],ne=(e,t)=>{const n=[],a=t.data;if(!a)return{isLoading:t.isLoading,isErrored:!!t.error,data:void 0,hasData:!1,loading:t.isLoading};n.push({seriesName:"tpm()",data:a.y.data.map((e=>{let[t,[{count:n}]]=e;return{name:t,value:n}}))}),n.push({seriesName:"tpm() lower bound",data:a.yhat_lower.data.map((e=>{let[t,[{count:n}]]=e;return{name:t,value:n}}))}),n.push({seriesName:"tpm() upper bound",data:a.yhat_upper.data.map((e=>{let[t,[{count:n}]]=e;return{name:t,value:n}}))});const o=t.data.anomalies,s=o.filter((e=>"high"===e.confidence)).map(te),i=o.filter((e=>"high"===e.confidence)).map((e=>({xAxis:e.start,name:ee(e)}))),r=o.filter((e=>"low"===e.confidence)).map(te),d=o.filter((e=>"low"===e.confidence)).map((e=>({xAxis:e.start,name:ee(e)})));return n.push({seriesName:"High Confidence",color:S.ZP.red300,data:[],silent:!0,markLine:(0,g.Z)({animation:!1,lineStyle:{color:S.ZP.red300,type:"solid",width:1,opacity:1},data:i,label:{show:!0,rotate:90,color:S.ZP.red300,position:"insideEndBottom",fontSize:"10",offset:[5,5],formatter:e=>`${e.data.name}`}}),markArea:(0,h.Z)({itemStyle:{color:S.ZP.red300,opacity:.2},label:{show:!1},data:s})}),n.push({seriesName:"Low Confidence",color:S.ZP.yellow200,data:[],markLine:(0,g.Z)({animation:!1,lineStyle:{color:S.ZP.yellow200,type:"solid",width:1,opacity:1},data:d,label:{show:!0,rotate:90,color:S.ZP.yellow300,position:"insideEndBottom",fontSize:"10",offset:[5,5],formatter:e=>`${e.data.name}`}}),markArea:(0,h.Z)({itemStyle:{color:S.ZP.yellow200,opacity:.2},label:{show:!1},data:r})}),{isLoading:t.isLoading,isErrored:!!t.error,data:n,hasData:!0,loading:t.isLoading}};function ae(e){const t=S.ZP.charts.colors[0],n=(0,c.useMemo)((()=>({fields:"",component:t=>(0,N.tZ)(c.Fragment,{children:t.children(e.queryData)}),transform:ne})),[e.queryData]);return(0,N.tZ)(k.I,{...e,title:(0,a.t)("Transaction Count"),titleTooltip:(0,a.t)("Represents transaction count across time, with added visualizations to highlight anomalies in your data."),fields:[""],chartSetting:_.s.TPM_AREA,chartDefinition:_.W[_.s.TPM_AREA],Subtitle:()=>(0,N.tZ)("div",{}),HeaderActions:()=>(0,N.tZ)("div",{}),EmptyComponent:P.xq,Queries:{chart:n},Visualizations:[{component:e=>{const n=e.widgetData.chart.data?.map((e=>("tpm()"!==e.seriesName&&(e.lineStyle={type:"dashed",color:t,width:1.5}),"score"===e.seriesName&&(e.lineStyle={color:S.ZP.red400}),e)))??[];return(0,N.tZ)(Y,{...e,data:n,height:250,statsPeriod:void 0,start:null,end:null})},height:250}]})}function oe(e){const{location:t,organization:n,eventView:a}=e,o=(0,D.ro)(t.query.query,"");return(0,N.BX)(Z.or,{fullWidth:!0,children:[(0,N.BX)(se,{children:[(0,N.BX)(v.Z,{condensed:!0,children:[(0,N.tZ)(f.Z,{}),(0,N.tZ)(y.Z,{alignDropdown:"left"})]}),(0,N.tZ)(x.Z,{organization:n,projectIds:a.project,query:o,fields:a.fields,onSearch:(s="query",function(e){const n=(0,w.fK)({...t.query||{},[s]:e}),a=["cursor"];(0,j.ri)(e)||a.push(s);const o=u()(n,a);p.browserHistory.push({...t,query:o})})})]}),(0,N.tZ)(C.Z,{organization:n,location:t,eventView:a,children:t=>(0,N.BX)(c.Fragment,{children:[(0,N.tZ)(ie,{children:(0,N.tZ)(ae,{...e,queryData:t})}),(0,N.tZ)(F,{anomalies:t.data?.anomalies,...e,isLoading:t.isLoading})]})})]});var s}ae.displayName="Anomalies",oe.displayName="AnomaliesContent";const se=(0,l.Z)("div",{target:"e1mll81g1"})("display:grid;gap:",(0,b.D)(2),";margin-bottom:",(0,b.D)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:auto 1fr;}"),ie=(0,l.Z)("div",{target:"e1mll81g0"})("margin-bottom:",(0,b.D)(2),";"),re=oe;var de=n("./app/views/performance/transactionSummary/transactionAnomalies/utils.tsx");function le(e){const{location:t,organization:n,projects:a}=e;return(0,N.tZ)(o.kP,{children:(0,N.tZ)(r.ZP,{location:t,organization:n,projects:a,tab:d.Z.Anomalies,generateEventView:de.h2,getDocumentTitle:ce,childComponent:re})})}function ce(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,a.t)("Performance")].join(" - "):[(0,a.t)("Summary"),(0,a.t)("Performance")].join(" - ")}le.displayName="TransactionAnomalies";const pe=(0,i.Z)((0,s.Z)(le))}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionAnomalies_index_tsx.cd2503f642fd39101c2334c16672cde6.js.map