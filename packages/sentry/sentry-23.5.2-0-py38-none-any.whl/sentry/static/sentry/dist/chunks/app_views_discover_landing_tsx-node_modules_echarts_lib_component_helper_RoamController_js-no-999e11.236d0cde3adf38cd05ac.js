(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_discover_landing_tsx-node_modules_echarts_lib_component_helper_RoamController_js-no-999e11"],{"./app/components/activity/item/avatar.tsx":(e,t,r)=>{"use strict";r.d(t,{q:()=>l});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=r("./app/components/avatar/userAvatar.tsx"),n=r("./app/components/placeholder.tsx"),a=r("./app/icons/index.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){let{className:t,type:r,user:s,size:a=38}=e;return s?(0,i.tZ)(o.Z,{user:s,size:a,className:t}):"system"===r?(0,i.tZ)(d,{className:t,size:a,children:(0,i.tZ)(u,{size:"md"})}):(0,i.tZ)(n.Z,{className:t,width:`${a}px`,height:`${a}px`,shape:"circle"})}l.displayName="ActivityAvatar";const d=(0,s.Z)("span",{target:"ef4o3hd1"})("display:flex;justify-content:center;align-items:center;width:",(e=>e.size),"px;height:",(e=>e.size),"px;background-color:",(e=>e.theme.textColor),";color:",(e=>e.theme.background),";border-radius:50%;"),u=(0,s.Z)(a.iW,{target:"ef4o3hd0"})({name:"1p2ly5v",styles:"padding-bottom:3px"})},"./app/components/charts/areaChart.tsx":(e,t,r)=>{"use strict";r.d(t,{T:()=>a});var s=r("./app/components/charts/series/lineSeries.tsx"),o=r("./app/components/charts/baseChart.tsx"),n=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{series:t,stacked:r,colors:a,...i}=e;return(0,n.tZ)(o.Z,{...i,"data-test-id":"area-chart",colors:a,series:t.map(((e,t)=>{let{seriesName:o,data:n,...i}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.Z)({...e})}({stack:r?"area":void 0,name:o,data:n.map((e=>{let{name:t,value:r}=e;return[t,r]})),lineStyle:{color:a?.[t],opacity:1,width:.4},areaStyle:{color:a?.[t],opacity:1},animation:!1,animationThreshold:1,animationDuration:0,...i})}))})}a.displayName="AreaChart"},"./app/components/charts/components/visualMap.tsx":(e,t,r)=>{"use strict";function s(e){return e}r.d(t,{Z:()=>s}),r("../node_modules/echarts/lib/component/visualMap.js")},"./app/components/charts/eventsGeoRequest.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var s=r("../node_modules/react/index.js"),o=r("./app/utils/dates.tsx"),n=r("./app/utils/discover/eventView.tsx"),a=r("./app/utils/discover/genericDiscoverQuery.tsx"),i=r("./app/utils/toArray.tsx"),l=r("./app/utils/usePrevious.tsx");const d=e=>{let{api:t,organization:r,yAxis:d,query:u,orderby:c,projects:p,period:h,start:m,end:g,environments:y,referrer:v,children:f,dataset:x}=e;const b=(0,s.useMemo)((()=>n.ZP.fromSavedQuery({id:void 0,name:"",version:2,fields:(0,i.Z)(d),query:u,orderby:c??"",projects:p,range:h??"",start:m?(0,o.v5)(m):void 0,end:g?(0,o.v5)(g):void 0,environment:y,dataset:x})),[d,u,c,p,h,m,g,y,x]),[Z,w]=(0,s.useState)(void 0),[_,C]=(0,s.useState)(!1),[D,j]=(0,s.useState)(!1),q=(0,l.Z)(t),z=(0,l.Z)(b),A=(0,l.Z)(r.slug),k=(0,l.Z)(v);return(0,s.useEffect)((()=>{let e=!0;return j(!1),q===t&&z===b&&A===r.slug&&k===v||C(!0),(0,a.AA)(t,`/organizations/${r.slug}/events-geo/`,{...b.generateQueryStringObject(),referrer:v}).then((t=>{e&&(w([t[0]]),C(!1))})).catch((()=>{e&&(j(!0),C(!1))})),()=>{e=!1}}),[t,b,r.slug,v,q,z,A,k]),f({errored:D,loading:!Z&&!D,reloading:_,tableData:Z})}},"./app/components/charts/lineChart.tsx":(e,t,r)=>{"use strict";r.d(t,{w:()=>a});var s=r("./app/components/charts/series/lineSeries.tsx"),o=r("./app/components/charts/baseChart.tsx"),n=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{series:t,seriesOptions:r,...a}=e;return(0,n.tZ)(o.Z,{...a,series:t.map((e=>{let{seriesName:t,data:o,dataArray:n,...a}=e;return(0,s.Z)({...r,...a,name:t,data:n||o?.map((e=>{let{value:t,name:r}=e;return[r,t]})),animation:!1,animationThreshold:1,animationDuration:0})}))})}a.displayName="LineChart"},"./app/components/charts/worldMapChart.tsx":(e,t,r)=>{"use strict";r.d(t,{y:()=>v});var s=r("../node_modules/react/index.js"),o=r("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),n=r("../node_modules/echarts/lib/core/echarts.js"),a=r("../node_modules/lodash/max.js"),i=r.n(a),l=r("./app/components/charts/components/visualMap.tsx");r("../node_modules/echarts/lib/chart/map.js");var d=r("./app/components/charts/baseChart.tsx"),u=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c=1.3,p=1.1,h=.9,m=10.97,g=-12,y=9.71;function v(e){let{series:t,seriesOptions:a,fromDiscover:v,fromDiscoverQueryList:f,...x}=e;const b=(0,o.u)(),[Z,w]=(0,s.useState)((()=>({countryToCodeMap:null,map:null,codeToCountryMap:null})));if((0,s.useEffect)((()=>{let e=!1;return e||async function(){try{const[e,t]=await Promise.all([r.e("app_data_countryCodesMap_tsx").then(r.bind(r,"./app/data/countryCodesMap.tsx")),r.e("app_data_world_json").then(r.t.bind(r,"./app/data/world.json",19))]),s=e.default,o=t.default;n.je?.("sentryWorld",o);const a={};for(const e in o)a[s[e]]=e;w({countryToCodeMap:s,map:o,codeToCountryMap:a})}catch{}}(),()=>{e=!0}}),[]),null===Z.countryToCodeMap||null===Z.map)return null;const _=t.map((e=>{let{seriesName:t,data:r,...s}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{map:""};return{roam:!0,...e,emphasis:{label:{show:!1},...e.emphasis},type:"map"}}({...a,...s,map:"sentryWorld",name:t,nameMap:Z.countryToCodeMap??void 0,aspectScale:.85,zoom:v?p:f?h:c,center:[m,f?g:y],itemStyle:{areaColor:b.gray200,borderColor:b.backgroundSecondary},emphasis:{itemStyle:{areaColor:b.pink300},label:{show:!1}},data:r,silent:f,roam:!f})})),C=i()(t.map((e=>{let{data:t}=e;return i()(t.map((e=>{let{value:t}=e;return t})))})))||1;return(0,u.tZ)(d.Z,{options:{backgroundColor:f?void 0:b.background,visualMap:[(0,l.Z)({show:!f,left:v?void 0:"right",right:v?5:void 0,min:0,max:C,inRange:{color:[b.purple200,b.purple300]},text:["High","Low"],textStyle:{color:b.textColor},calculable:!1})]},...x,yAxis:null,xAxis:null,series:_,tooltip:{formatter:e=>{const{marker:t,name:r,value:s}=Array.isArray(e)?e[0]:e;if(isNaN(s))return"";const o="number"==typeof s?s.toLocaleString():"";return[`<div class="tooltip-series tooltip-series-solo">\n               <div><span class="tooltip-label">${t} <strong>${Z.codeToCountryMap?.[r]||r}</strong></span> ${o}</div>\n            </div>`,'<div class="tooltip-arrow"></div>'].join("")}},height:v?400:void 0})}v.displayName="WorldMapChart"},"./app/components/searchBar.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>y,p:()=>g});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=r("../node_modules/react/index.js"),n=r("./app/components/button.tsx"),a=r("./app/components/inputGroup.tsx"),i=r("./app/icons/index.tsx"),l=r("./app/icons/iconClose.tsx"),d=r("./app/locale.tsx"),u=r("./app/styles/space.tsx"),c=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{query:t,defaultQuery:r="",onChange:s,onSearch:n,width:u,size:p,className:y,trailing:v,...f}=e;const x=(0,o.useRef)(null),[b,Z]=(0,o.useState)(t??r);(0,o.useEffect)((()=>{"string"==typeof t&&Z(t)}),[t]);const w=(0,o.useCallback)((e=>{const{value:t}=e.target;Z(t),s?.(t)}),[s]),_=(0,o.useCallback)((e=>{e.preventDefault(),x.current?.blur(),n?.(b)}),[n,b]),C=(0,o.useCallback)((()=>{Z(""),s?.(""),n?.("")}),[s,n]);return(0,c.tZ)(h,{onSubmit:_,className:y,children:(0,c.BX)(a.BZ,{children:[(0,c.tZ)(a.BZ.LeadingItems,{disablePointerEvents:!0,children:(0,c.tZ)(i.jV,{color:"subText",size:"xs"===p?"xs":"sm"})}),(0,c.tZ)(m,{...f,ref:x,type:"text",name:"query",autoComplete:"off",value:b,onChange:w,width:u,size:p}),(0,c.BX)(a.BZ.TrailingItems,{children:[v,!!b&&(0,c.tZ)(g,{size:"zero",borderless:!0,onClick:C,icon:(0,c.tZ)(l.b,{size:"xs"}),"aria-label":(0,d.t)("Clear")})]})]})})}p.displayName="SearchBar";const h=(0,s.Z)("form",{target:"elu65nr2"})({name:"4bgdod",styles:"display:block;position:relative"}),m=(0,s.Z)(a.BZ.Input,{target:"elu65nr1"})((e=>e.width&&`width: ${e.width};`),";"),g=(0,s.Z)(n.zx,{target:"elu65nr0"})("color:",(e=>e.theme.subText),";padding:",(0,u.D)(.5),";"),y=p},"./app/utils/discover/genericDiscoverQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{AA:()=>x,JC:()=>Z,ZP:()=>w,o:()=>h});var s=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(r("../node_modules/core-js/modules/es.error.cause.js"),r("../node_modules/react/index.js")),n=r("../node_modules/@tanstack/react-query/build/lib/useQuery.mjs"),a=r("./app/api.tsx"),i=r("./app/locale.tsx"),l=r("./app/utils/discover/eventView.tsx"),d=r("./app/utils/performance/contexts/performanceEventViewContext.tsx"),u=r("./app/utils/useApi.tsx"),c=r("./app/utils/useOrganization.tsx"),p=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class h{constructor(e,t){(0,s.Z)(this,"message",void 0),(0,s.Z)(this,"originalError",void 0),this.message=e,this.originalError=t}getOriginalError(){return this.originalError}}class m extends o.Component{constructor(){super(...arguments),(0,s.Z)(this,"state",{isLoading:!0,tableFetchID:void 0,error:null,tableData:null,pageLinks:null,api:new a.KU}),(0,s.Z)(this,"_shouldRefetchData",(e=>{const t=b(this.props),r=b(e);return!(0,l.ze)(t,r)||e.limit!==this.props.limit||e.route!==this.props.route||e.cursor!==this.props.cursor})),(0,s.Z)(this,"_parseError",(e=>{if(this.props.parseError)return this.props.parseError(e);if(!e)return null;const t=e.responseJSON?.detail;if("string"==typeof t)return new h(t,e);const r=t?.message;return new h("string"==typeof r?r:(0,i.t)("An unknown error occurred."),e)})),(0,s.Z)(this,"fetchData",(async()=>{const{queryBatching:e,beforeFetch:t,afterFetch:r,didFetch:s,eventView:o,orgSlug:n,route:a,setError:i}=this.props,{api:l}=this.state;if(!o.isValid())return;const d=`/organizations/${n}/${a}/`,u=Symbol("tableFetchID"),c=b(this.props);this.setState({isLoading:!0,tableFetchID:u}),i?.(void 0),t?.(l),l.clear();try{const[t,,o]=await x(l,d,c,{queryBatching:e});if(this.state.tableFetchID!==u)return;const n=r?r(t,this.props):t;s?.(n),this.setState((e=>({isLoading:!1,tableFetchID:void 0,error:null,pageLinks:o?.getResponseHeader("Link")??e.pageLinks,tableData:n})))}catch(e){const t=this._parseError(e);this.setState({isLoading:!1,tableFetchID:void 0,error:t,tableData:null}),i&&i(t??void 0)}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){const t=this._shouldRefetchData(e),r=!1===e.eventView.isValid()&&this.props.eventView.isValid(),s=!!this.props.shouldRefetchData&&this.props.shouldRefetchData(e,this.props);(t||r||s)&&this.fetchData()}render(){const{isLoading:e,error:t,tableData:r,pageLinks:s}=this.state,o={isLoading:e,error:t,tableData:r,pageLinks:s},n=this.props.children;return n?.(o)}}function g(e){const t=(0,c.Z)({allowNull:!0})?.slug,r=(0,o.useContext)(d.uL)?.eventView,s=e.orgSlug??t,n=e.eventView??r;if(void 0===s||void 0===n)throw new Error("GenericDiscoverQuery requires both an orgSlug and eventView");const a={...e,orgSlug:s,eventView:n};return(0,p.tZ)(m,{...a})}m.displayName="_GenericDiscoverQuery",g.displayName="GenericDiscoverQuery";const y=200,v=2,f=e=>new Promise((t=>setTimeout(t,e)));async function x(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{queryBatching:o,retry:n}=s;if(o?.batchRequest)return o.batchRequest(e,t,{query:r,includeAllArgs:!0});const a=n?.baseTimeout??y,i=n?.timeoutMultiplier??v,l=n?.statusCodes??[],d=n?.tries??1;let u,c=0,p=0;for(;c<d&&(!u||l.includes(u.status));){p>0&&await f(p);try{return c++,await e.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{...r}})}catch(e){u=e,p=a*i**(c-1)}}throw u}function b(e){const{cursor:t,limit:r,noPagination:s,referrer:o,getRequestPayload:n,eventView:a,location:i,forceAppendRawQueryString:l}=e,d=n?n(e):a.getEventsAPIPayload(i,l);return t&&(d.cursor=t),r&&(d.per_page=r),s&&(d.noPagination=s),o&&(d.referrer=o),Object.assign(d,e.queryExtras??{}),d}function Z(e){const t=(0,u.Z)(),{orgSlug:r,route:s,options:o}=e,a=`/organizations/${r}/${s}/`,i=b(e);return(0,n.a)([s,i],(async()=>{const[r]=await x(t,a,i,{queryBatching:e.queryBatching});return r}),o)}const w=g},"./app/utils/performance/contexts/performanceEventViewContext.tsx":(e,t,r)=>{"use strict";r.d(t,{bq:()=>o,uL:()=>a});var s=r("./app/utils/performance/contexts/utils.tsx");const[o,n,a]=(0,s.n)({name:"PerformanceEventViewContext"})},"./app/utils/performance/contexts/utils.tsx":(e,t,r)=>{"use strict";r.d(t,{n:()=>o}),r("../node_modules/core-js/modules/es.error.cause.js");var s=r("../node_modules/react/index.js");function o(e){const{strict:t=!0,errorMessage:r=`useContext for "${e.name}" must be inside a Provider with a value`,name:o}=e,n=(0,s.createContext)(void 0);return n.displayName=o,[n.Provider,function(){const e=(0,s.useContext)(n);if(!e&&t)throw new Error(r);return e},n]}},"./app/views/discover/landing.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{DiscoverLanding:()=>Me,default:()=>Le});var s=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(r("../node_modules/core-js/modules/es.array.push.js"),r("../node_modules/react-router/es/index.js")),a=r("../node_modules/lodash/isEqual.js"),i=r.n(a),l=r("../node_modules/lodash/pick.js"),d=r.n(l),u=r("./app/components/acl/feature.tsx"),c=r("./app/components/alert.tsx"),p=r("./app/components/asyncComponent.tsx"),h=r("./app/components/breadcrumbs.tsx"),m=r("./app/components/button.tsx"),g=r("./app/components/compactSelect/index.tsx"),y=r("./app/components/layouts/thirds.tsx"),v=r("./app/components/searchBar.tsx"),f=r("./app/components/sentryDocumentTitle.tsx"),x=r("./app/components/switchButton.tsx"),b=r("./app/locale.tsx"),Z=r("./app/styles/space.tsx"),w=r("./app/utils/analytics.tsx"),_=r("./app/utils/discover/eventView.tsx"),C=r("./app/utils/discover/urls.tsx"),D=r("./app/utils/queryString.tsx"),j=r("./app/utils/withOrganization.tsx"),q=r("../node_modules/react/index.js"),z=r("../node_modules/moment/moment.js"),A=r.n(z),k=r("./app/actionCreators/pageFilters.tsx"),S=r("./app/components/dropdownMenu/index.tsx"),M=r("./app/components/emptyStateWarning.tsx"),P=r("./app/components/pagination.tsx"),Q=r("./app/components/timeSince.tsx"),B=r("./app/icons/index.tsx"),L=r("./app/utils/parseLinkHeader.tsx"),E=r("./app/utils/withApi.tsx"),N=r("./app/views/discover/savedQuery/utils.tsx"),T=(r("../node_modules/core-js/modules/es.error.cause.js"),r("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js")),R=r("./app/components/charts/areaChart.tsx"),Y=r("./app/components/charts/barChart.tsx"),X=r("./app/components/charts/eventsGeoRequest.tsx"),V=r("./app/components/charts/eventsRequest.tsx"),O=r("./app/components/charts/lineChart.tsx"),$=r("./app/components/charts/utils.tsx"),F=r("./app/components/charts/worldMapChart.tsx"),G=r("./app/components/loadingIndicator.tsx"),H=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function I(e){let{isLoading:t=!1,isReloading:r=!1,maskBackgroundColor:s,className:o,children:n}=e;const a=(0,T.u)(),i=t||r;return(0,H.BX)(W,{className:o,children:[i&&(0,H.BX)("div",{children:[(0,H.tZ)(U,{isReloading:r,maskBackgroundColor:s??a.white}),(0,H.tZ)(J,{})]}),n]})}I.displayName="LoadingContainer";const W=(0,o.Z)("div",{target:"eh2paf42"})({name:"bjn8wh",styles:"position:relative"}),U=(0,o.Z)("div",{target:"eh2paf41"})("position:absolute;z-index:1;background-color:",(e=>e.maskBackgroundColor),";width:100%;height:100%;opacity:",(e=>e.isReloading?"0.6":"1"),";"),J=(0,o.Z)(G.Z,{target:"eh2paf40"})({name:"1aa909c",styles:"position:absolute;z-index:3;width:100%"});var K=r("./app/utils/dates.tsx"),ee=r("./app/utils/discover/charts.tsx"),te=r("./app/utils/discover/fields.tsx"),re=r("./app/utils/discover/types.tsx");class se extends q.Component{shouldComponentUpdate(e){return!i()(this.getRefreshProps(this.props),this.getRefreshProps(e))}getRefreshProps(e){const{organization:t,location:r,eventView:s,yAxis:o}=e,n=s.getEventsAPIPayload(r),a=n.query,i=n.start?(0,K.hC)(n.start):null,l=n.end?(0,K.hC)(n.end):null,d=n.statsPeriod,u=s.getDisplayMode(),c=u===re.DC.TOP5||u===re.DC.DAILYTOP5,p=u===re.DC.DAILYTOP5||u===re.DC.DAILY,h=c?n.field:void 0,m=c?re.hY:void 0,g=c?(0,D.ro)(n.sort):void 0,y="bar"===u?"low":"high";return{organization:t,apiPayload:n,query:a,start:i,end:l,period:d,interval:p?"1d":s.interval?s.interval:(0,$.ZS)({start:i,end:l,period:d},y),project:s.project,environment:s.environment,yAxis:o??s.getYAxis(),field:h,topEvents:m,orderby:g,showDaily:p,expired:s.expired,name:s.name,display:u}}getChartType(e){let{showDaily:t}=e;return t?"bar":"area"}getChartComponent(e){switch(e){case"bar":return Y.v;case"line":return O.w;case"area":return R.T;default:throw new Error(`Unknown multi plot type for ${e}`)}}render(){const{theme:e,api:t,referrer:r}=this.props,{query:s,start:o,end:n,period:a,interval:i,organization:l,project:d,environment:u,yAxis:c,field:p,topEvents:h,orderby:m,showDaily:g,expired:y,name:v,display:f}=this.getRefreshProps(this.props);return f===re.DC.WORLDMAP?(0,H.tZ)(X.Z,{api:t,organization:l,yAxis:c,query:s,orderby:m,projects:d,period:a,start:o,end:n,environments:u,referrer:r,children:e=>{let{errored:t,loading:r,tableData:s}=e;if(t)return(0,H.tZ)(oe,{children:(0,H.tZ)(B.FC,{color:"gray300",size:"md"})});if(r)return(0,H.tZ)(oe,{children:(0,H.tZ)(G.Z,{mini:!0})});const{data:o,title:n}=(0,$.JT)(s),a={height:100,series:[{seriesName:n,data:o}],fromDiscoverQueryList:!0};return(0,H.tZ)(F.y,{...a})}}):(0,H.tZ)(V.Z,{organization:l,api:t,query:s,start:o,end:n,period:a,interval:i,project:d,environment:u,includePrevious:!1,yAxis:c,field:p,topEvents:h,orderby:m,expired:y,name:v,referrer:r,hideError:!0,partial:!0,children:t=>{let{loading:r,timeseriesData:s,results:o,errored:n,errorMessage:a}=t;if(n)return(0,H.BX)(oe,{children:[(0,H.tZ)(B.FC,{color:"gray300",size:"md"}),(0,H.tZ)(ne,{children:a})]});if(r)return(0,H.tZ)(oe,{children:(0,H.tZ)(G.Z,{mini:!0})});const i=s??o??[],l="bar"===f?f:this.getChartType({showDaily:g,yAxis:Array.isArray(c)?c[0]:c,timeseriesData:i}),d=i.map((e=>({...e,lineStyle:{opacity:"line"===l?1:0}}))),u=h&&h+1===i.length,p=i.length?[...e.charts.getColorPalette(i.length-2-(u?1:0))]:void 0;p&&p.length&&u&&p.push(e.chartOther);const m={colors:p,height:150,series:[...d],xAxis:{show:!1,axisPointer:{show:!1}},yAxis:{show:!0,axisLine:{show:!1},axisLabel:{color:e.chartLabel,fontFamily:e.text.family,fontSize:12,formatter:e=>(0,ee.gu)(e,(0,te.Px)(Array.isArray(c)?c[0]:c),!0),inside:!0,showMinLabel:!1,showMaxLabel:!1},splitNumber:3,splitLine:{show:!1},zlevel:e.zIndex.header},tooltip:{show:!1},toolBox:{show:!1},grid:{left:0,top:0,right:0,bottom:0,containLabel:!1},stacked:"number"==typeof h&&h>0||Array.isArray(c)&&c.length>1},y=this.getChartComponent(l);return(0,H.tZ)(y,{...m})}})}}se.displayName="MiniGraph";const oe=(0,o.Z)((e=>(0,H.tZ)(I,{...e,maskBackgroundColor:"transparent"})),{target:"e1m7wqi11"})({name:"khkb4p",styles:"height:150px;display:flex;justify-content:center;align-items:center"}),ne=(0,o.Z)("div",{target:"e1m7wqi10"})("color:",(e=>e.theme.gray300),";margin-left:4px;"),ae=(0,E.Z)((0,T.b)(se));var ie=r("./app/components/activity/item/avatar.tsx"),le=r("./app/components/card.tsx"),de=r("./app/components/errorBoundary.tsx"),ue=r("./app/components/links/link.tsx");class ce extends q.PureComponent{constructor(){super(...arguments),(0,s.Z)(this,"handleClick",(()=>{const{onEventClick:e}=this.props;e?.()}))}render(){const{title:e,subtitle:t,queryDetail:r,renderContextMenu:s,renderGraph:o,createdBy:n,dateStatus:a}=this.props;return(0,H.tZ)(ue.Z,{"data-test-id":`card-${e}`,onClick:this.handleClick,to:this.props.to,children:(0,H.BX)(me,{interactive:!0,children:[(0,H.BX)(ge,{children:[(0,H.BX)(he,{children:[(0,H.tZ)(ye,{children:e}),(0,H.tZ)(ve,{children:r})]}),(0,H.tZ)(pe,{children:n?(0,H.tZ)(ie.q,{type:"user",user:n,size:34}):(0,H.tZ)(ie.q,{type:"system",size:34})})]}),(0,H.tZ)(fe,{children:(0,H.tZ)(we,{mini:!0,children:o()})}),(0,H.BX)(xe,{children:[(0,H.BX)(be,{children:[t,a?(0,H.BX)(Ze,{children:[(0,b.t)("Edited")," ",a]}):null]}),s&&s()]})]})})}}ce.displayName="QueryCard";const pe=(0,o.Z)("span",{target:"em58jqy10"})("border:3px solid ",(e=>e.theme.border),";border-radius:50%;height:min-content;"),he=(0,o.Z)("div",{target:"em58jqy9"})("flex-grow:1;overflow:hidden;margin-right:",(0,Z.D)(1),";"),me=(0,o.Z)(le.Z,{target:"em58jqy8"})({name:"1h9y2eg",styles:"justify-content:space-between;height:100%;&:focus,&:hover{top:-1px;}"}),ge=(0,o.Z)("div",{target:"em58jqy7"})("display:flex;padding:",(0,Z.D)(1.5)," ",(0,Z.D)(2),";"),ye=(0,o.Z)("div",{target:"em58jqy6"})((e=>e.theme.text.cardTitle),";color:",(e=>e.theme.headingColor),";",(e=>e.theme.overflowEllipsis),";font-weight:initial;"),ve=(0,o.Z)("div",{target:"em58jqy5"})("font-family:",(e=>e.theme.text.familyMono),";font-size:",(e=>e.theme.fontSizeSmall),";color:",(e=>e.theme.gray300),";line-height:1.5;",(e=>e.theme.overflowEllipsis),";"),fe=(0,o.Z)("div",{target:"em58jqy4"})("background:",(e=>e.theme.backgroundSecondary),";max-height:150px;height:100%;overflow:hidden;"),xe=(0,o.Z)("div",{target:"em58jqy3"})("display:flex;justify-content:space-between;align-items:center;padding:",(0,Z.D)(1)," ",(0,Z.D)(2),";"),be=(0,o.Z)("div",{target:"em58jqy2"})("font-size:",(e=>e.theme.fontSizeSmall),";display:grid;grid-column-gap:",(0,Z.D)(1),";",(e=>e.theme.overflowEllipsis),";color:",(e=>e.theme.textColor),";"),Ze=(0,o.Z)("span",{target:"em58jqy1"})("color:",(e=>e.theme.subText),";padding-left:",(0,Z.D)(1),";"),we=(0,o.Z)(de.Z,{target:"em58jqy0"})({name:"qu9742",styles:"margin-bottom:100px"}),_e=ce;var Ce=r("./app/views/discover/utils.tsx");class De extends q.Component{constructor(){super(...arguments),(0,s.Z)(this,"handleDeleteQuery",(e=>{const{api:t,organization:r,onQueryChange:s,location:o,savedQueries:a}=this.props;(0,N.Uc)(t,r,e).then((()=>{1===a.length&&o.query.cursor?n.browserHistory.push({pathname:o.pathname,query:{...o.query,cursor:void 0}}):s()}))})),(0,s.Z)(this,"handleDuplicateQuery",((e,t)=>{const{api:r,location:s,organization:o,onQueryChange:a}=this.props;(e=e.clone()).name=`${e.name} copy`,(0,N.b2)(r,o,e,t).then((()=>{a(),n.browserHistory.push({pathname:s.pathname,query:{}})}))}))}componentDidMount(){(0,k.Z5)()}renderQueries(){const{pageLinks:e,renderPrebuilt:t}=this.props,r=(0,L.Z)(e||"");let s=[];return!t||r.previous&&!1!==r.previous.results||(s=s.concat(this.renderPrebuiltQueries())),s=s.concat(this.renderSavedQueries()),0===s.filter((e=>e)).length?(0,H.tZ)(Ae,{children:(0,H.tZ)("p",{children:(0,b.t)("No saved queries match that filter")})}):s}renderDropdownMenu(e){return(0,H.tZ)(S.h,{items:e,trigger:e=>(0,H.tZ)(ze,{...e,"aria-label":(0,b.t)("Query actions"),size:"xs",borderless:!0,onClick:t=>{t.stopPropagation(),t.preventDefault(),e.onClick?.(t)},icon:(0,H.tZ)(B.YR,{direction:"down",size:"sm"}),"data-test-id":"menu-trigger"}),position:"bottom-end",offset:4})}renderPrebuiltQueries(){const{api:e,location:t,organization:r,savedQuerySearchQuery:s,router:o}=this.props,n=(0,Ce.Ur)(r),a="string"==typeof s&&s.length>0,i=a?s.toLowerCase():"";return n.map(((s,n)=>{const l=_.ZP.fromNewQueryWithLocation(s,t);if(a&&l.name&&!l.name.toLowerCase().includes(i))return null;const d=(0,b.t)("Last ")+l.statsPeriod,c=A()(l.start).format("MMM D, YYYY h:mm A")+" - "+A()(l.end).format("MMM D, YYYY h:mm A"),p=l.getResultsViewUrlTarget(r.slug),h=[{key:"add-to-dashboard",label:(0,b.t)("Add to Dashboard"),onAction:()=>(0,Ce.F_)({eventView:l,location:t,query:s,organization:r,yAxis:s?.yAxis,router:o})},{key:"set-as-default",label:(0,b.t)("Set as Default"),onAction:()=>{(0,N.RF)(e,r,l.toNewQuery()),(0,w.Gi)("discover_v2.set_as_default",{organization:r,source:"context-menu",type:"prebuilt-query"})}}];return(0,H.tZ)(_e,{to:p,title:l.name,subtitle:l.statsPeriod?d:c,queryDetail:l.query,createdBy:l.createdBy,renderGraph:()=>(0,H.tZ)(ae,{location:t,eventView:l,organization:r,referrer:"api.discover.homepage.prebuilt"}),onEventClick:()=>{(0,w.Gi)("discover_v2.prebuilt_query_click",{organization:r,query_name:l.name})},renderContextMenu:()=>(0,H.tZ)(u.Z,{organization:r,features:["dashboards-edit"],children:e=>{let{hasFeature:t}=e;return t&&this.renderDropdownMenu(h)}})},`${n}-${l.name}`)}))}renderSavedQueries(){const{api:e,savedQueries:t,location:r,organization:s,router:o}=this.props;return t&&Array.isArray(t)&&0!==t.length?t.map(((t,n)=>{const a=_.ZP.fromSavedQuery(t),i=(0,b.t)("Last ")+a.statsPeriod,l=A()(a.start).format("MMM D, YYYY h:mm A")+" - "+A()(a.end).format("MMM D, YYYY h:mm A"),d=a.getResultsViewShortUrlTarget(s.slug),c=(0,H.tZ)(Q.Z,{date:t.dateUpdated}),p=`api.discover.${a.getDisplayMode()}-chart`,h=n=>[...n?[{key:"add-to-dashboard",label:(0,b.t)("Add to Dashboard"),onAction:()=>(0,Ce.F_)({eventView:a,location:r,query:t,organization:s,yAxis:t?.yAxis??a.yAxis,router:o})}]:[],{key:"set-as-default",label:(0,b.t)("Set as Default"),onAction:()=>{(0,N.RF)(e,s,a.toNewQuery()),(0,w.Gi)("discover_v2.set_as_default",{organization:s,source:"context-menu",type:"saved-query"})}},{key:"duplicate",label:(0,b.t)("Duplicate Query"),onAction:()=>this.handleDuplicateQuery(a,(0,D.qP)(t.yAxis))},{key:"delete",label:(0,b.t)("Delete Query"),priority:"danger",onAction:()=>this.handleDeleteQuery(a)}];return(0,H.tZ)(_e,{to:d,title:a.name,subtitle:a.statsPeriod?i:l,queryDetail:a.query,createdBy:a.createdBy,dateStatus:c,onEventClick:()=>{(0,w.Gi)("discover_v2.saved_query_click",{organization:s})},renderGraph:()=>(0,H.tZ)(ae,{location:r,eventView:a,organization:s,referrer:p,yAxis:t.yAxis&&t.yAxis.length?t.yAxis:["count()"]}),renderContextMenu:()=>(0,H.tZ)(u.Z,{organization:s,features:["dashboards-edit"],children:e=>{let{hasFeature:t}=e;return this.renderDropdownMenu(h(t))}})},`${n}-${a.id}`)})):[]}render(){const{pageLinks:e}=this.props;return(0,H.BX)(q.Fragment,{children:[(0,H.tZ)(qe,{children:this.renderQueries()}),(0,H.tZ)(je,{pageLinks:e,onCursor:(e,t,r,s)=>{const o=Number(e?.split(":")?.[1]??0),a={...r,cursor:e};o<=0&&-1===s&&delete a.cursor,n.browserHistory.push({pathname:t,query:a})}})]})}}De.displayName="QueryList";const je=(0,o.Z)(P.Z,{target:"e1gxha1n3"})({name:"1azpx8r",styles:"margin-bottom:20px"}),qe=(0,o.Z)("div",{target:"e1gxha1n2"})("display:grid;grid-template-columns:minmax(100px, 1fr);gap:",(0,Z.D)(2),";@media (min-width: ",(e=>e.theme.breakpoints.medium),"){grid-template-columns:repeat(2, minmax(100px, 1fr));}@media (min-width: ",(e=>e.theme.breakpoints.large),"){grid-template-columns:repeat(3, minmax(100px, 1fr));}"),ze=(0,o.Z)(m.zx,{target:"e1gxha1n1"})("transform:translateX(",(0,Z.D)(1),");"),Ae=(0,o.Z)(M.Z,{target:"e1gxha1n0"})({name:"1wygoze",styles:"grid-column:1/4"}),ke=(0,E.Z)(De),Se=[{label:(0,b.t)("My Queries"),value:"myqueries"},{label:(0,b.t)("Recently Edited"),value:"-dateUpdated"},{label:(0,b.t)("Query Name (A-Z)"),value:"name"},{label:(0,b.t)("Date Created (Newest)"),value:"-dateCreated"},{label:(0,b.t)("Date Created (Oldest)"),value:"dateCreated"},{label:(0,b.t)("Most Outdated"),value:"dateUpdated"},{label:(0,b.t)("Most Popular"),value:"mostPopular"},{label:(0,b.t)("Recently Viewed"),value:"recentlyViewed"}];class Me extends p.Z{constructor(){super(...arguments),(0,s.Z)(this,"state",{loading:!0,reloading:!1,error:!1,errors:{},renderPrebuilt:(0,Ce.tG)(),savedQueries:null,savedQueriesPageLinks:""}),(0,s.Z)(this,"shouldReload",!0),(0,s.Z)(this,"handleQueryChange",(()=>{this.fetchData({reloading:!0})})),(0,s.Z)(this,"handleSearchQuery",(e=>{const{location:t}=this.props;n.browserHistory.push({pathname:t.pathname,query:{...t.query,cursor:void 0,query:String(e).trim()||void 0}})})),(0,s.Z)(this,"handleSortChange",(e=>{const{location:t,organization:r}=this.props;(0,w.Gi)("discover_v2.change_sort",{organization:r,sort:e}),n.browserHistory.push({pathname:t.pathname,query:{...t.query,cursor:void 0,sort:e}})})),(0,s.Z)(this,"togglePrebuilt",(()=>{const{renderPrebuilt:e}=this.state;this.setState({renderPrebuilt:!e},(()=>{(0,Ce.u)(!e),this.fetchData({reloading:!0})}))}))}getSavedQuerySearchQuery(){const{location:e}=this.props;return(0,D.ro)(e.query.query,"").trim()}getActiveSort(){const{location:e}=this.props,t=(0,D.ro)(e.query.sort,"myqueries");return Se.find((e=>e.value===t))||Se[0]}getEndpoints(){const{organization:e,location:t}=this.props,r=(0,Ce.Ur)(e),s=this.getSavedQuerySearchQuery(),o=(0,D.ro)(t.query.cursor);let n=9;const a=this.state?this.state.renderPrebuilt:(0,Ce.tG)();if(!o&&a)if(s&&s.length>0){const e=s.toLowerCase(),o=r.reduce(((r,s)=>{const o=_.ZP.fromNewQueryWithLocation(s,t);return o.name&&o.name.toLowerCase().includes(e)?r+1:r}),0);n=Math.max(1,n-o)}else n=Math.max(1,n-r.length);const i={cursor:o,query:`version:2 name:"${s}"`,per_page:n.toString(),sortBy:this.getActiveSort().value};return o||delete i.cursor,[["savedQueries",`/organizations/${e.slug}/discover/saved/`,{query:i}]]}componentDidUpdate(e){const t=["sort","cursor","query"];!i()(d()(e.location.query,t),d()(this.props.location.query,t))&&this.fetchData()}renderActions(){const e=this.getActiveSort(),{renderPrebuilt:t,savedQueries:r}=this.state;return(0,H.BX)(Be,{children:[(0,H.tZ)(Qe,{defaultQuery:"",query:this.getSavedQuerySearchQuery(),placeholder:(0,b.t)("Search saved queries"),onSearch:this.handleSearchQuery}),(0,H.BX)(Pe,{children:["Show Prebuilt",(0,H.tZ)(x.Z,{isActive:t,isDisabled:t&&0===(r??[]).length,size:"lg",toggle:this.togglePrebuilt})]}),(0,H.tZ)(g.Z,{triggerProps:{prefix:(0,b.t)("Sort By")},value:e.value,options:Se,onChange:e=>this.handleSortChange(e.value),position:"bottom-end"})]})}renderNoAccess(){return(0,H.tZ)(y.T3,{withPadding:!0,children:(0,H.tZ)(c.bZ,{type:"warning",children:(0,b.t)("You don't have access to this feature")})})}renderBody(){const{location:e,organization:t,router:r}=this.props,{savedQueries:s,savedQueriesPageLinks:o,renderPrebuilt:n}=this.state;return(0,H.tZ)(ke,{pageLinks:o,savedQueries:s??[],savedQuerySearchQuery:this.getSavedQuerySearchQuery(),renderPrebuilt:n,location:e,organization:t,onQueryChange:this.handleQueryChange,router:r})}renderBreadcrumbs(){return(0,H.tZ)(h.Z,{crumbs:[{key:"discover-homepage",label:(0,b.t)("Discover"),to:(0,C.zR)(this.props.organization)},{key:"discover-saved-queries",label:(0,b.t)("Saved Queries")}]})}render(){const{organization:e}=this.props,t=`/organizations/${e.slug}/discover/homepage/`;return(0,H.tZ)(u.Z,{organization:e,features:["discover-query"],renderDisabled:this.renderNoAccess,children:(0,H.tZ)(f.Z,{title:(0,b.t)("Discover"),orgSlug:e.slug,children:(0,H.BX)(y.T3,{children:[(0,H.BX)(y.h4,{children:[(0,H.tZ)(y.oB,{children:this.renderBreadcrumbs()}),(0,H.tZ)(y.kP,{children:(0,H.tZ)(m.zx,{"data-test-id":"build-new-query",to:t,size:"sm",priority:"primary",onClick:()=>{(0,w.Gi)("discover_v2.build_new_query",{organization:e})},children:(0,b.t)("Build a new query")})})]}),(0,H.tZ)(y.uT,{children:(0,H.BX)(y.or,{fullWidth:!0,children:[this.renderActions(),this.renderComponent()]})})]})})})}}Me.displayName="DiscoverLanding";const Pe=(0,o.Z)("label",{target:"e7ih3za2"})("display:flex;align-items:center;gap:",(0,Z.D)(1.5),";font-weight:normal;margin:0;"),Qe=(0,o.Z)(v.Z,{target:"e7ih3za1"})({name:"1ff36h2",styles:"flex-grow:1"}),Be=(0,o.Z)("div",{target:"e7ih3za0"})("display:grid;gap:",(0,Z.D)(2),";grid-template-columns:auto max-content min-content;align-items:center;margin-bottom:",(0,Z.D)(2),";@media (max-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:auto;}"),Le=(0,j.Z)(Me)},"../node_modules/echarts/lib/component/helper/RoamController.js":(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var s=r("../node_modules/echarts/node_modules/tslib/tslib.es6.js"),o=r("../node_modules/zrender/lib/core/Eventful.js"),n=r("../node_modules/zrender/lib/core/event.js"),a=r("../node_modules/echarts/lib/component/helper/interactionMutex.js"),i=r("../node_modules/zrender/lib/core/util.js");function l(e,t,r,s,o){e.pointerChecker&&e.pointerChecker(s,o.originX,o.originY)&&(n.sT(s.event),d(e,t,r,s,o))}function d(e,t,r,s,o){o.isAvailableBehavior=(0,i.bind)(u,null,r,s),e.trigger(t,o)}function u(e,t,r){var s=r[e];return!e||s&&(!(0,i.isString)(s)||t.event[s+"Key"])}const c=function(e){function t(t){var r=e.call(this)||this;r._zr=t;var s=(0,i.bind)(r._mousedownHandler,r),o=(0,i.bind)(r._mousemoveHandler,r),n=(0,i.bind)(r._mouseupHandler,r),a=(0,i.bind)(r._mousewheelHandler,r),l=(0,i.bind)(r._pinchHandler,r);return r.enable=function(e,r){this.disable(),this._opt=(0,i.defaults)((0,i.clone)(r)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),null==e&&(e=!0),!0!==e&&"move"!==e&&"pan"!==e||(t.on("mousedown",s),t.on("mousemove",o),t.on("mouseup",n)),!0!==e&&"scale"!==e&&"zoom"!==e||(t.on("mousewheel",a),t.on("pinch",l))},r.disable=function(){t.off("mousedown",s),t.off("mousemove",o),t.off("mouseup",n),t.off("mousewheel",a),t.off("pinch",l)},r}return(0,s.ZT)(t,e),t.prototype.isDragging=function(){return this._dragging},t.prototype.isPinching=function(){return this._pinching},t.prototype.setPointerChecker=function(e){this.pointerChecker=e},t.prototype.dispose=function(){this.disable()},t.prototype._mousedownHandler=function(e){if(!n.x1(e)){for(var t=e.target;t;){if(t.draggable)return;t=t.__hostTarget||t.parent}var r=e.offsetX,s=e.offsetY;this.pointerChecker&&this.pointerChecker(e,r,s)&&(this._x=r,this._y=s,this._dragging=!0)}},t.prototype._mousemoveHandler=function(e){if(this._dragging&&u("moveOnMouseMove",e,this._opt)&&"pinch"!==e.gestureEvent&&!a.Tf(this._zr,"globalPan")){var t=e.offsetX,r=e.offsetY,s=this._x,o=this._y,i=t-s,l=r-o;this._x=t,this._y=r,this._opt.preventDefaultMouseMove&&n.sT(e.event),d(this,"pan","moveOnMouseMove",e,{dx:i,dy:l,oldX:s,oldY:o,newX:t,newY:r,isAvailableBehavior:null})}},t.prototype._mouseupHandler=function(e){n.x1(e)||(this._dragging=!1)},t.prototype._mousewheelHandler=function(e){var t=u("zoomOnMouseWheel",e,this._opt),r=u("moveOnMouseWheel",e,this._opt),s=e.wheelDelta,o=Math.abs(s),n=e.offsetX,a=e.offsetY;if(0!==s&&(t||r)){if(t){var i=o>3?1.4:o>1?1.2:1.1;l(this,"zoom","zoomOnMouseWheel",e,{scale:s>0?i:1/i,originX:n,originY:a,isAvailableBehavior:null})}if(r){var d=Math.abs(s);l(this,"scrollMove","moveOnMouseWheel",e,{scrollDelta:(s>0?1:-1)*(d>3?.4:d>1?.15:.05),originX:n,originY:a,isAvailableBehavior:null})}}},t.prototype._pinchHandler=function(e){a.Tf(this._zr,"globalPan")||l(this,"zoom",null,e,{scale:e.pinchScale>1?1.1:1/1.1,originX:e.pinchX,originY:e.pinchY,isAvailableBehavior:null})},t}(o.Z)},"../node_modules/lodash/negate.js":e=>{e.exports=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},"../node_modules/lodash/omitBy.js":(e,t,r)=>{var s=r("../node_modules/lodash/_baseIteratee.js"),o=r("../node_modules/lodash/negate.js"),n=r("../node_modules/lodash/pickBy.js");e.exports=function(e,t){return n(e,o(s(t)))}}}]);
//# sourceMappingURL=../sourcemaps/app_views_discover_landing_tsx-node_modules_echarts_lib_component_helper_RoamController_js-no-999e11.2b24f20732e83c028b2fa756631dd810.js.map