var oe=Object.defineProperty;var ie=(t,e,n)=>e in t?oe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var h=(t,e,n)=>(ie(t,typeof e!="symbol"?e+"":e,n),n);import{B as S,au as g,av as ae,S as le,i as ce,s as ue,e as k,b as V,f as _,g as x,t as b,d as U,h as j,a0 as fe,o as de,v as F,w as C,x as W,y as L,R as G,a3 as X,z as M,H as me,E as Y,a9 as he}from"./index-c73596c9.js";function pe(t){return t===Object(t)}function _e(t,e){return Object.keys(t).reduce(function(n,s){return n[s]=e(t[s]),n},{})}function O(t,e){return t&&(t.is_store?e(t):Array.isArray(t)?t.map(n=>O(n,e)):pe(t)?_e(t,n=>O(n,e)):e(t))}function ge(t){const{subscribe:e,set:n,update:s}=S(t),r=S(0);return{subscribe:e,update:s,set:(o,l=!0)=>{n(o),l&&r.update(c=>c+1)},triggerStore:r,storeId:null,backendStore:null}}const p=new Map,xe=t=>O(t,e=>{if(!e)return e;if(e.store_id!==void 0){if(!p.has(e.store_id)){let n=ge(e.value);n.storeId=e.store_id,n.backendStore=e.has_children,p.set(e.store_id,n)}return p.get(e.store_id)}else if(e.refId!==void 0)return p.has(e.refId)||p.set(e.refId,S(e)),p.get(e.refId);return e});async function v(t,e){const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await n.json();if(!n.ok)throw console.log("HTTP status "+n.status+": "+n.statusText+`
 url: `+t+`
 data: `+JSON.stringify(e)),new Error("HTTP status "+n.status+": "+s.detail);return s}async function ye(t,e){const n=await v(t,e);return Z(n)}function Z(t){for(const e of t)if(e.type==="ref"){if(!p.has(e.id))continue;p.get(e.id).update(s=>(s.scope=e.scope,s))}else if(e.type==="store"){const n=p.get(e.id);if(n===void 0){console.log("Store is not maintained on the frontend. Only stores passed as props to a component are maintained in `globalStores`.",e.id);continue}if(!("triggerStore"in n))throw"Must use `meerkatWritable` for backend stores.";e.value!==g(n)&&n.set(e.value,!1)}}function we(t,e,n,s){var r,a,i=!1,o="withOld"in n,l=(f,u)=>{if(r=u,o&&(a=f),!i){let w=e(f,u);if(e.length<2)u(w);else return w}i=!1},c=ae(t,l,s),m=!Array.isArray(t),y=f=>{m?(i=!0,t.set(f)):f.forEach((u,w)=>{i=!0,t[w].set(u)}),i=!1};o&&(n=n.withOld);var te=n.length>=(o?3:2),T=null;function ne(f){if(T&&(T(),T=null),o)var u=n(f,a,y);else var u=n(f,y);te?typeof u=="function"&&(T=u):y(u)}var R=!1;function N(f){var u,w,B,D;if(R){D=f(g(c)),r(D);return}var se=c.subscribe(re=>{R?u?w=!0:u=!0:B=re});D=f(B),R=!0,r(D),se(),R=!1,w&&(D=g(c)),u&&ne(D)}return{subscribe:c.subscribe,set(f){N(()=>f)},update:N}}const be=20,I=S([]),H=S(null),E=new Map,K=t=>{if(E.has(t))return;const e=setTimeout(()=>{E.delete(t),ee(t)},1e3);E.set(t,e)},Ie=t=>{const e=E.get(t);e&&clearTimeout(e)};function De(t){t.id&&Ie(t.id),I.update(e=>e.map(n=>n.id===t.id?{...n,...t}:n))}function Se(t){I.update(e=>[t,...e].slice(0,be))}function ke(t){g(I).find(e=>e.id===t.id)?De(t):Se(t)}function Pe(t){I.update(e=>(t?K(t):e.forEach(n=>{K(n.id)}),e.map(n=>n.id===t||t===void 0?{...n,visible:!1}:n)))}function ee(t){I.update(e=>t===void 0?[]:e.filter(n=>n.id!==t))}function Ue(t){H.set(t)}function je(t){let e;H.update(n=>(e=t-(n||0),null)),I.update(n=>n.map(s=>({...s,pauseDuration:s.pauseDuration+e})))}const Te={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3};function He(t={}){return{toasts:we(I,n=>n.map(s=>{var r,a;return{...t,...t[s.type],...s,duration:s.duration||((r=t[s.type])==null?void 0:r.duration)||(t==null?void 0:t.duration)||Te[s.type],style:[t.style,(a=t[s.type])==null?void 0:a.style,s.style].join(";")}}),n=>n),pausedAt:H}}const Re=t=>typeof t=="function",Q=(t,e)=>Re(t)?t(e):t,Ee=(()=>{let t=0;return()=>(t+=1,t.toString())})(),Ne=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){const e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),ve=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||Ee()}),P=t=>(e,n)=>{const s=ve(e,t,n);return ke(s),s.id},d=(t,e)=>P("blank")(t,e);d.error=P("error");d.success=P("success");d.loading=P("loading");d.custom=P("custom");d.dismiss=t=>{Pe(t)};d.remove=t=>ee(t);d.promise=(t,e,n)=>{const s=d.loading(e.loading,{...n,...n==null?void 0:n.loading});return t.then(r=>(d.success(Q(e.success,r),{id:s,...n,...n==null?void 0:n.success}),r)).catch(r=>{d.error(Q(e.error,r),{id:s,...n,...n==null?void 0:n.error})}),t};const A=d,$=S({VITE_API_URL_PLACEHOLDER:"http://meerkat.dummy",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}.VITE_API_URL||"http://meerkat.dummy");class Ae{constructor(e,n,s,r,a,i=null){h(this,"columnInfos");h(this,"columns");h(this,"posidxs");h(this,"keyidxs");h(this,"rows");h(this,"fullLength");h(this,"primaryKey");h(this,"refId");this.columnInfos=e,this.columns=this.columnInfos.map(l=>l.name),this.posidxs=n,this.rows=s,this.fullLength=r,this.primaryKey=a,this.refId=i;let o=this.columns.findIndex(l=>l===a);this.keyidxs=this.rows.map(l=>l[o])}getCell(e,n){let s=this.columns.indexOf(n);if(s===-1)throw new Error(`Column ${n} does not exist in this DataFrame`);let r=this.columnInfos[s];return{data:this.rows[e][this.columns.indexOf(n)],cellInfo:this.refId!==null?{dfRefId:this.refId,columnName:n,row:e}:null,cellComponent:r.cellComponent,cellProps:r.cellProps,cellDataProp:r.cellDataProp,column:n}}getColumn(e){let n=this.columns.indexOf(e),s=this.columnInfos[n];return console.log(e),{data:this.rows.map(r=>r[n]),cellComponent:s.cellComponent,cellProps:s.cellProps,cellDataProp:s.cellDataProp,column:e}}getRow(e){let n={};for(let s=0;s<this.columns.length;s++)n[this.columns[s]]=this.rows[e][s];return n}getRows(){let e=[];for(let n=0;n<this.rows.length;n++)e.push(this.getRow(n));return e}length(){return this.rows.length}}const Be=async(t,e)=>await ye(`${g($)}/store/${t}/update/`,{value:e}).catch(r=>{throw console.log(r),A.error(r.message),r}),Fe=async(t,e={})=>{if(t===null)return;const n=v(`${g($)}/endpoint/${t}/dispatch/`,e).catch(i=>{throw console.log(i),A.error(i.message),i}),{result:s,modifications:r,error:a}=await n;return Z(r),s},Ke=async({df:t,columns:e=null,formatter:n=null})=>await v(`${g($)}/df/${t.refId}/schema/`,{columns:e,formatter:n}).catch(r=>{throw console.log(r),A.error(r.message),r}),Qe=async({df:t,columns:e=null,start:n=null,end:s=null,posidxs:r=null,keyidxs:a=null,keyColumn:i=null,formatter:o=null,shuffle:l=null})=>{const m=await v(`${g($)}/df/${t.refId}/rows/`,{start:n,end:s,posidxs:r,key_column:i,keyidxs:a,columns:e,formatter:o,shuffle:l}).catch(y=>{throw console.log(y),A.error(y.message),y});return new Ae(m.columnInfos,m.posidxs,m.rows,m.fullLength,m.primaryKey,t.refId)};function J(t,e,n){const s=t.slice();return s[6]=e[n],s}function q(t){let e,n,s;const r=[t[0]];var a=t[2];function i(o){let l={$$slots:{default:[$e]},$$scope:{ctx:o}};for(let c=0;c<r.length;c+=1)l=Y(l,r[c]);return{props:l}}return a&&(e=F(a,i(t)),e.$on("edit",t[4])),{c(){e&&C(e.$$.fragment),n=k()},l(o){e&&W(e.$$.fragment,o),n=k()},m(o,l){e&&L(e,o,l),V(o,n,l),s=!0},p(o,l){const c=l&1?G(r,[X(o[0])]):{};if(l&514&&(c.$$scope={dirty:l,ctx:o}),a!==(a=o[2])){if(e){x();const m=e;b(m.$$.fragment,1,0,()=>{M(m,1)}),U()}a?(e=F(a,i(o)),e.$on("edit",o[4]),C(e.$$.fragment),_(e.$$.fragment,1),L(e,n.parentNode,n)):e=null}else a&&e.$set(c)},i(o){s||(e&&_(e.$$.fragment,o),s=!0)},o(o){e&&b(e.$$.fragment,o),s=!1},d(o){o&&j(n),e&&M(e,o)}}}function z(t){let e,n;const s=[t[6]];let r={};for(let a=0;a<s.length;a+=1)r=Y(r,s[a]);return e=new Me({props:r}),{c(){C(e.$$.fragment)},l(a){W(e.$$.fragment,a)},m(a,i){L(e,a,i),n=!0},p(a,i){const o=i&2?G(s,[X(a[6])]):{};e.$set(o)},i(a){n||(_(e.$$.fragment,a),n=!0)},o(a){b(e.$$.fragment,a),n=!1},d(a){M(e,a)}}}function $e(t){let e,n,s=t[1],r=[];for(let i=0;i<s.length;i+=1)r[i]=z(J(t,s,i));const a=i=>b(r[i],1,1,()=>{r[i]=null});return{c(){for(let i=0;i<r.length;i+=1)r[i].c();e=k()},l(i){for(let o=0;o<r.length;o+=1)r[o].l(i);e=k()},m(i,o){for(let l=0;l<r.length;l+=1)r[l].m(i,o);V(i,e,o),n=!0},p(i,o){if(o&2){s=i[1];let l;for(l=0;l<s.length;l+=1){const c=J(i,s,l);r[l]?(r[l].p(c,o),_(r[l],1)):(r[l]=z(c),r[l].c(),_(r[l],1),r[l].m(e.parentNode,e))}for(x(),l=s.length;l<r.length;l+=1)a(l);U()}},i(i){if(!n){for(let o=0;o<s.length;o+=1)_(r[o]);n=!0}},o(i){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)b(r[o]);n=!1},d(i){he(r,i),i&&j(e)}}}function Ce(t){let e,n,s=t[2]&&q(t);return{c(){s&&s.c(),e=k()},l(r){s&&s.l(r),e=k()},m(r,a){s&&s.m(r,a),V(r,e,a),n=!0},p(r,[a]){r[2]?s?(s.p(r,a),a&4&&_(s,1)):(s=q(r),s.c(),_(s,1),s.m(e.parentNode,e)):s&&(x(),b(s,1,1,()=>{s=null}),U())},i(r){n||(_(s),n=!0)},o(r){b(s),n=!1},d(r){s&&s.d(r),r&&j(e)}}}function Le(t,e,n){const s=fe("Components");let{name:r}=e,{props:a}=e,{slots:i=[]}=e;console.log("props",a);let o;de(async()=>{if(r in s){n(2,o=s[r]);return}});function l(c){me.call(this,t,c)}return t.$$set=c=>{"name"in c&&n(3,r=c.name),"props"in c&&n(0,a=c.props),"slots"in c&&n(1,i=c.slots)},t.$$.update=()=>{t.$$.dirty&8&&n(2,o=s[r])},[a,i,o,r,l]}class Me extends le{constructor(e){super(),ce(this,e,Le,Ce,ue,{name:3,props:0,slots:1})}}export{$ as A,Me as D,Ae as a,Qe as b,De as c,Fe as d,je as e,Ke as f,Be as g,p as h,xe as i,Ne as p,Ue as s,A as t,He as u};
