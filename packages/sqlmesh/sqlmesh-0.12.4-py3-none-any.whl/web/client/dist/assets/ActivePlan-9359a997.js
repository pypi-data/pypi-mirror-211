import{v,u as j,l as r,j as t,g as P,r as b,m as i,D as n,H as A,b as C,I as T,G as p,T as k}from"./index-3144ef62.js";import{T as l}from"./TasksOverview-158a5095.js";import{L as o}from"./popover-6da25bfe.js";import{t as E}from"./transition-b76f66ee.js";import"./pluralize-ca1790d5.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./context-677a5bfa.js";import"./keyboard-896332ff.js";import"./use-resolve-button-type-acdcfc49.js";function G({plan:a}){const d=v(),g=j(e=>e.environment),s=r(e=>e.state),c=r(e=>e.setState),m=r(e=>e.setAction);function x(){c(n.Cancelling),m(p.Cancelling),k(d).catch(console.error).finally(()=>{m(p.None),c(n.Cancelled)})}return t.jsx(o,{className:"relative flex",children:()=>t.jsxs(t.Fragment,{children:[t.jsx(o.Button,{className:P("inline-block ml-1 px-2 py-[3px] rounded-[4px] text-xs font-bold",F(s)),children:a==null?0:1}),t.jsx(E,{as:b.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:t.jsx(o.Panel,{className:"absolute right-1 z-10 mt-8 transform",children:t.jsxs("div",{className:"overflow-hidden rounded-lg bg-theme shadow-lg ring-1 ring-black ring-opacity-5",children:[t.jsx(l,{tasks:a.tasks,children:({total:e,completed:h,models:u,completedBatches:y,totalBatches:f})=>t.jsxs(t.Fragment,{children:[t.jsx(l.Summary,{environment:g.name,planState:s,headline:"Most Recent Plan",completed:h,total:e,completedBatches:y,totalBatches:f,updateType:a.type===i.Virtual?"Virtual":"Backfill",updatedAt:a.updated_at}),u!=null&&t.jsx(l.Details,{models:u,showBatches:a.type!==i.Virtual,showVirtualUpdate:a.type===i.Virtual,showProgress:!0})]})}),t.jsx("div",{className:"my-4 px-4",children:s===n.Applying&&t.jsx(A,{size:C.sm,variant:T.Danger,className:"mx-0",onClick:e=>{e.stopPropagation(),x()},children:"Cancel"})})]})})})]})})}function F(a){return a===n.Finished?"bg-success-500 text-light":a===n.Failed?"bg-danger-500 text-light":a===n.Applying?"bg-secondary-500 text-light":"bg-neutral-100 text-neutral-500"}export{G as default};
