# Options for Tox itself, and other tools {{{

[tox]
envlist = linter, py3{9,10,11,12}
isolated_build = True
skip_missing_interpreters = True
skipsdist = True

# Options for the flake8 linter (and vim-flake8).
# E741 (ambiguous variable name): "l" is used for lightness a lot.
[flake8]
extend-ignore = E741
exclude = .git,.tox,__pycache__,build,dist


# }}}
# Default environments housing the core CI tests {{{

[testenv]
description = run tests using pytest
skip_install = True
deps =
    -r requirements.txt
setenv =
    PYTHONDONTWRITEBYTECODE=1
commands_pre =
    pip-sync-faster
commands =
    {posargs:pytest --showlocals --doctest-modules -- tests}


[testenv:linter]
description = run the flake8 linter
commands =
    {posargs:flake8 -- colorsysx tests}


# }}}
# Additional helper/utility environments {{{


[testenv:freeze]
description = update frozen dev requirements.txt with pip-compile
deps = .[dev]
commands =
    pip-compile -o requirements.txt --upgrade --resolver=backtracking --extra dev pyproject.toml


# }}}
