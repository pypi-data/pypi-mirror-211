ARG PYTHON_VERSION=3.10
FROM python:${PYTHON_VERSION}-slim AS base

ARG VECTOR_PIPELINES_VERSION
ARG VECTOR_PIPELINES_EXTRA_DEPS

RUN pip install vector_pipelines${VECTOR_PIPELINES_EXTRA_DEPS:+[${VECTOR_PIPELINES_EXTRA_DEPS}]}${VECTOR_PIPELINES_VERSION:+==${VECTOR_PIPELINES_VERSION}}

FROM base AS service

RUN pip install vector_pipelines${VECTOR_PIPELINES_VERSION:+==${VECTOR_PIPELINES_VERSION}}[grpc]

ENTRYPOINT ["vector_pipelines", "service", "start"]
