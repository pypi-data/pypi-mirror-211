apiVersion: ec2.aws.infra/v1alpha1
kind: SecurityGroup
metadata:
  Description: managed by https://git.toolsfdg.net/devops/devops-infra
  GroupName:
    $lower:
      $underscore: ${prefix}_${env}_${name}_alb_sg
  VpcId: ${cluster-vpc-id}
spec:
  ingress:
    - FromPort: 80
      ToPort: 80
      IpProtocol: tcp
      IpRanges:
        - CidrIp: 172.21.0.0/16
          Description: all vpc
    
    - FromPort: 443
      ToPort: 443
      IpProtocol: tcp
      IpRanges:
        - CidrIp: 172.21.0.0/16
          Description: all vpc
    
    - FromPort: 80
      ToPort: 80
      IpProtocol: tcp
      UserIdGroupPairs:
        - Description: Allow alb access
          GroupId: $file(alb.sg.yaml)
